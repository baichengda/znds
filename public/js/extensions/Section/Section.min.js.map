{"version":3,"sources":["webpack://Autodesk.Extensions.[name]/webpack/bootstrap","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/isObject.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/_root.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/_Symbol.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/isObjectLike.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/_baseGetTag.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/isSymbol.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/debounce.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/_freeGlobal.js","webpack://Autodesk.Extensions.[name]/./node_modules/css-loader/lib/css-base.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/toNumber.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/now.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/_baseTrim.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/_trimmedEndIndex.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/_getRawTag.js","webpack://Autodesk.Extensions.[name]/./node_modules/lodash/_objectToString.js","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/lib/addStyles.js","webpack://Autodesk.Extensions.[name]/./node_modules/style-loader/lib/urls.js","webpack://Autodesk.Extensions.[name]/./extensions/Section/Section.css?22a4","webpack://Autodesk.Extensions.[name]/./extensions/Section/Section.css","webpack://Autodesk.Extensions.[name]/(webpack)/buildin/global.js","webpack://Autodesk.Extensions.[name]/./thirdparty/three.js/TransformControls.js","webpack://Autodesk.Extensions.[name]/./extensions/Section/SectionTool.js","webpack://Autodesk.Extensions.[name]/./extensions/Section/Section.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","type","freeGlobal","freeSelf","self","root","Function","getRawTag","objectToString","symToStringTag","undefined","baseGetTag","isObjectLike","isObject","now","toNumber","nativeMax","Math","max","nativeMin","min","func","wait","options","lastArgs","lastThis","maxWait","result","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","apply","leadingEdge","setTimeout","timerExpired","shouldInvoke","timeSinceLastCall","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","arguments","this","clearTimeout","cancel","flush","global","useSourceMap","list","toString","map","item","content","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","sourceURLs","sources","source","sourceRoot","concat","join","cssWithMappingToString","mediaQuery","alreadyImportedModules","length","id","push","baseTrim","isSymbol","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","other","valueOf","isBinary","test","slice","Date","trimmedEndIndex","reTrimStart","string","replace","reWhitespace","index","charAt","objectProto","nativeObjectToString","isOwn","tag","unmasked","e","fn","memo","stylesInDom","isOldIE","window","document","all","atob","getTarget","target","parent","querySelector","getElement","styleTarget","HTMLIFrameElement","contentDocument","head","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","refs","j","parts","addStyle","listToStyles","newStyles","base","part","css","media","insertStyleElement","style","insertInto","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","createElement","attrs","nonce","getNonce","addAttrs","el","keys","forEach","setAttribute","obj","update","remove","transform","default","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","updateLink","href","applyToTag","newObj","DEBUG","newList","mayRemove","textStore","replaceText","replacement","filter","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","location","baseUrl","protocol","host","currentDir","pathname","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","locals","g","init_TransformGizmos","GizmoMaterial","parameters","THREE","MeshBasicMaterial","depthTest","depthWrite","side","FrontSide","transparent","setValues","oldColor","color","clone","oldOpacity","opacity","highlight","highlighted","setRGB","copy","GizmoLineMaterial","LineBasicMaterial","linewidth","PolyhedronGeometry","vertices","indices","radius","detail","Geometry","that","prepare","Vector3","faces","v1","v2","v3","Face3","centroid","subdivide","faceVertexUvs","uvs","x0","x","x1","x2","multiplyScalar","vector","vertex","normalize","u","azimuth","PI","v","atan2","y","sqrt","z","inclination","uv","Vector2","make","face","add","divideScalar","azi","correctUV","cols","pow","a","b","aj","lerp","bj","rows","k","floor","mergeVertices","computeFaceNormals","boundingSphere","Sphere","OctahedronGeometry","TorusGeometry","tube","radialSegments","tubularSegments","arc","center","normals","cos","sin","sub","pointerVector","pointerDir","ray","createCircleGeometry","facing","geometry","createArrowGeometry","radiusTop","radiusBottom","height","heightSegments","openEnded","arrowGeometry","mesh","Mesh","CylinderGeometry","position","updateMatrix","merge","matrix","createLineGeometry","axis","lineGeometry","TransformGizmo","includeAxis","scope","init","Object3D","handles","pickers","planes","highlights","hemiPicker","subPickers","planeGeometry","PlaneBufferGeometry","planeMaterial","wireframe","DoubleSide","activePlane","rotation","set","visible","setupGizmos","activeMode","traverse","child","tempGeometry","BufferGeometry","fromBufferGeometry","scale","hide","show","material","addGizmos","gizmoMap","visble","setHandlePickerGizmos","axisNames","handleGizmos","axisName","pickerGizmos","hemiPickerGizmos","highlightGizmos","subPickerGizmos","eye","vec1","vec2","lookAtMatrix","Matrix4","search","quaternion","setFromRotationMatrix","lookAt","setFromEuler","TransformGizmoTranslate","lineXGeometry","lineYGeometry","lineZGeometry","X","Line","Y","Z","XYZ","XY","YZ","XZ","BoxGeometry","setActivePlane","isLocalSpace","tempMatrix","applyMatrix4","getInverse","extractRotation","matrixWorld","abs","TransformGizmoRotate","RX","RY","RZ","RE","RXYZE","eye2","worldRotation","Euler","tempQuaternion","Quaternion","unitX","unitY","unitZ","quaternionX","quaternionY","quaternionZ","makeRotationFromQuaternion","setFromAxisAngle","multiplyQuaternions","TransformGizmoTranslateRotate","theta","SphereGeometry","useAllPickers","TransformGizmoScale","TransformControls","camera","domElement","gizmo","snap","snapDelta","space","size","normal","startLine","endLine","LineDashedMaterial","centerLine","ImageUtils","loadTexture","Autodesk","Viewing","Private","getResourceUrl","magFilter","minFilter","NearestFilter","CircleGeometry","centerMark","ticks","h","_dragging","_mode","changeEvent","mouseDownEvent","mouseUpEvent","objectChangeEvent","point","Raycaster","offset","offsetRotation","clientScale","tempVector","projX","projY","projZ","quaternionXYZ","quaternionE","oldPosition","oldScale","oldRotationMatrix","parentRotationMatrix","parentScale","worldPosition","worldRotationMatrix","camPosition","intersectObjects","pointer","objects","canvasX","canvasY","attach","updateUnitVectors","detach","setMode","dispatchEvent","getPicker","children","setPosition","setNormal","setFromUnitVectors","applyQuaternion","multiply","setRotation","rotationMatrix","setSnap","delta","setSize","setSpace","updateMatrixWorld","setFromMatrixPosition","applyEuler","isPerspective","dist","distanceTo","tan","fov","top","bottom","rect","getBoundingClientRect","gizmoOffset","setGizmoOffset","vec","showRotationGizmos","onPointerHover","event","intersect","isDragging","onPointerDown","pointerType","button","planeIntersect","setFromMatrixScale","verticesNeedUpdate","pos","getAttribute","pt1","fromAttribute","pt2","pt3","pt4","dashSize","gapSize","computeLineDistances","onPointerMove","dot","rotz","rotsnap","round","tempAxis","cross","rot","angleTo","projx","projy","projz","tempx","tempy","tempz","rotx","roty","matrixAutoUpdate","onPointerUp","clientX","clientY","recursive","clientWidth","clientHeight","unproject","transformDirection","intersections","debounce","require","SectionMeshClass","avp","SectionTool","viewer","_transRotControl","_transControl","_trcOffset","_viewer","impl","_names","_active","_isDragging","_boxChanged","_isPlaneOn","_tintColor","tintColor","_tintIntensity","tintIntensity","_gizmoOffsetRight","isNaN","gizmoOffsetRight","_gizmoOffsetLeft","gizmoOffsetLeft","_gizmoOffsetTop","gizmoOffsetTop","_gizmoOffsetBottom","gizmoOffsetBottom","_gizmoNewClientPos","_controlOffset","_controlNewPosition","_sectionGroups","_sectionPlanes","_sectionPicker","_activeMode","_touchType","_initialized","_visibleAtFirst","_outlineIndices","_displaySectionHatches","sendAnalyticsDebounced","from","action","analytics","track","updateViewer","invalidate","updateControls","adjustGizmoToBounds","client","worldToClient","getCanvasBoundingClientRect","width","intersection","groupPosition","updateSections","updatePlaneMeshes","updateCapMeshes","Plane","setComponents","w","plane","planeVec","Vector4","constant","connectivity","outlines","constructor","getWorldPosition","init_SectionMesh","_fragIterator","_timeSlice","_sliceDelay","_callback","_models","_curModel","_instanceTree","_m","_d","_f","_capTimer","_dbIds","_fragIds","reset","models","doIteration","endTime","performance","next","nextModel","getInstanceTree","enumNodeChildren","getRootId","dbId","nextDbId","isNodeHidden","isNodeOff","enumNodeFragments","fragId","start","delay","callback","cg","Extensions","CompGeom","sceneAfter","skipDepthTarget","_removeSections","section3D","scene","section2D","toPlaneCoords","makePlaneBasis","fromPaneCoords","mat2dname","matman","create2DMaterial","skipCircles","skipEllipticals","isScreenSpace","mat2d","findMaterial","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","cutplanes","_otherCutPlanes","box","Box3","modelQueue","getModels","getDoNotCut","intersects","model","lastFrag","frags","getFragmentList","getWorldBounds","xBoxPlane","getVizmesh","is2d","isLines","xMeshPlane","bbox","convertToPlaneCoords","vbb","VertexBufferBuilder","Color","getDiffuseColor","eset","EdgeSet","snapEdges","sanitizeEdges","stitchContours","cset","triangulate","contours","cntr","pts","addSegment","mdata","toMesh","BufferGeometryUtils","meshToGeometry","bg2d","streamingDraw","streamingIndex","mesh2d","frustumCulled","modelId","triangulationFailed","bg","toPolygonMesh","packedNormals","mat","cloneMaterial","bumpMap","normalMap","alphaMap","specularMap","hatchPattern","needsUpdate","angle","hatchParams","hatchTintColor","hatchTintIntensity","prismType","defines","toUpperCase","capmesh","_ownCutPlaneSet","setCutPlaneSetFor2DRendering","createPlaneMesh","quat","ptMax","projectPoint","ptMin","invQuat","inverse","subVectors","getVisibleBounds","getBoundingSphere","pt","getCenter","presetIndex","currentLightPreset","bgColor","LightPresets","bgColorGradient","lineMaterial","fromArray","array","itemSize","line","rebuild","traverseSections","minv","connect","intersectPlanes","setXYZ","computeBoundingBox","computeBoundingSphere","setSectionPlanes","fireEvent","setCutPlaneSet","showPlane","showSection","attachControl","control","checkNormal","api","navigation","getEyeVector","negate","setPlane","distance","obbox","group","Group","addOverlay","centerPlaneArrow","centerOffset","middle","boundingBox","localToWorld","getCenterPoint","n23","n31","n12","Matrix3","plane1","plane2","plane3","optionalTarget","det","determinant","crossVectors","oldsection3D","getObjectByName","oldsection2D","isActive","getSectionDistance","eyeVec","hit","rayIntersect","Ray","intersectPoint","setViewerSection","clearSection","planeSet","getCutPlaneSet","v4","setSection","connectivities","loadingBox","meshes","orthoPoint","nc","ct","cornerOffset","setBox","recomputePivot","setSectionFromPlane","cutplane","setActiveMode","setDisplaySectionHatches","pop","removeOverlay","isPlaneOn","resetSection","getNames","getName","register","deregister","removeEventListener","removeOverlayScene","CAMERA_CHANGE_EVENT","ISOLATE_EVENT","HIDE_EVENT","SHOW_EVENT","MODEL_TRANSFORM_CHANGED_EVENT","getPriority","activate","canvas","addEventListener","overlayScenes","createOverlayScene","initControl","deactivate","keepCutPlanesOnDeactivate","handleSingleClick","prevObject","handleDoubleClick","handleSingleTap","handleDoubleTap","handleKeyDown","handleKeyUp","handleWheelInput","handleButtonDown","handleButtonUp","handleMouseMove","oldTransControlPos","boxOffset","includes","handleGesture","handleBlur","handleResize","handlePressHold","values","getSectionBoxValues","aabb","sectionBox","setPivotPoint","ignoreGlobalOffset","right","front","left","bttm","back","off","getData","globalOffset","sectionBoxTransform","identity","toArray","getSectionPlaneValues","sectionPlane","getSectionPlaneSet","getSectionPlanes","viewSet","notifyCutplanesChanged","numCutPlanesBefore","cpSets","getCutPlaneSets","cpName","cp","section","updateCapMaterials","setSectionBox","SceneMath","box2CutPlanes","setSectionPlane","enableRotationGizmo","planeVecs","AVU","UI","SectionExtension","Extension","modes","buttons","onViewerSetView","_onCutPlanesChanged","_onShowAll","proto","load","tool","toolController","registerTool","setActive","sectionStyle","supportedStyles","displaySectionHatches","prefs","addListeners","Prefs3D","DISPLAY_SECTION_HATCHES","SET_VIEW_EVENT","CUTPLANES_CHANGE_EVENT","SHOW_ALL_EVENT","HOTKEYS_ID","hotkeys","keycodes","KeyCode","ESCAPE","onRelease","getAggregateSelection","getHotkeyManager","pushHotkeys","registerContextMenuCallback","menu","status","hasSelected","aggregateSelection","selector","getSelectionBounds","menuEntry","title","From","Type","selected","selectionObject","selection","flat","modelIds","hitTest","getRenderProxy","normalMatrix","getNormalMatrix","applyMatrix3","onContextMenu","loadExtension","unload","unregisterContextMenuCallback","popHotkeys","destroyUI","removeListeners","deregisterTool","toggle","enableSectionTool","setSectionStyle","getSectionStyle","preserveSection","bActive","bNewStyle","prevLock","setIsLocked","enable","keepCutPlanes","activateTool","sectionToolButton","setState","Button","State","ACTIVE","prevKeepCutPlanes","deactivateTool","INACTIVE","activateToolModality","getViewValues","boxValues","planeValues","getState","viewerState","restoreState","activeStatus","clearSelection","calculateNearestAxis","xn","yn","zn","onToolbarCreated","toolbar","ComboButton","setToolTip","setIcon","createSubmenu","modelTools","getControl","TOOLBAR","MODELTOOLSID","resetTool","addControl","getId","parentButton","createNavToggler","state","sectionType","toLowerCase","isMobileDevice","updateSectionButtons","areVectorsEqual","sqtol","lengthSq","unitx","unity","unitz","autocam","getWorldRightVector","up","getWorldUpVector","getWorldFrontVector","tol","sectionYButton","sectionXButton","sectionZButton","onClick","sectionBoxButton","MODEL_ADDED_EVENT","once","removeFromParent","theExtensionManager","registerExtension"],"mappings":"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","file":"Section/Section.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 861);\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","var baseTrim = require('./_baseTrim'),\n    isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","var trimmedEndIndex = require('./_trimmedEndIndex');\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nmodule.exports = baseTrim;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nmodule.exports = trimmedEndIndex;\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (typeof __webpack_nonce__ === 'undefined') {\n\t\treturn null;\n\t}\n\n\treturn __webpack_nonce__;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = typeof options.transform === 'function'\n\t\t ? options.transform(obj.css) \n\t\t : options.transform.default(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./Section.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./Section.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/sass-loader/dist/cjs.js!./Section.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".sectionPanel{line-height:14px;text-align:left;z-index:10}.section-horizontal-divider{height:1px;border-top:1px solid rgba(200,200,200,0.8)}.section-submenu-select{display:block;position:relative;width:calc(100% - 40px);padding:10px 20px 0px 20px;opacity:0.3}.section-panel:hover .section-submenu-select{opacity:0.8}.section-submenu-selectlabel{position:relative;display:inline-block;padding-right:20px;padding-bottom:4px}.section-restart{margin:10px 20px 15px 20px;padding:6px 10px 6px 10px;width:calc(100% - 55px);cursor:pointer}.docking-panel:hover .section-restart{background-color:rgba(255,255,255,0.12)}.docking-panel .section-restart:hover{background-color:rgba(166,194,255,0.7);-webkit-transition:all 0.2s ease;-moz-transition:all 0.2s ease;-ms-transition:all 0.2s ease;-o-transition:all 0.2s ease;transition:all 0.2s ease}\\n\", \"\"]);\n\n// exports\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","/**\n * @author arodic / https://github.com/arodic\n *\n * @author chiena -- Modified for Autodesk LMV web viewer\n */\n /*jshint sub:true*/\n\nexport function init_TransformGizmos() {\n\n    'use strict';\n\n    var GizmoMaterial = function ( parameters ) {\n\n        THREE.MeshBasicMaterial.call( this );\n\n        this.depthTest = false;\n        this.depthWrite = false;\n        this.side = THREE.FrontSide;\n        this.transparent = true;\n\n        this.setValues( parameters );\n\n        this.oldColor = this.color.clone();\n        this.oldOpacity = this.opacity;\n\n        this.highlight = function( highlighted ) {\n\n            if ( highlighted ) {\n\n                this.color.setRGB( 1, 230/255, 3/255 );\n                this.opacity = 1;\n\n            } else {\n\n                this.color.copy( this.oldColor );\n                this.opacity = this.oldOpacity;\n\n            }\n\n        };\n\n    };\n\n    GizmoMaterial.prototype = Object.create( THREE.MeshBasicMaterial.prototype );\n\n    var GizmoLineMaterial = function ( parameters ) {\n\n        THREE.LineBasicMaterial.call( this );\n\n        this.depthTest = false;\n        this.depthWrite = false;\n        this.transparent = true;\n        this.linewidth = 1;\n\n        this.setValues( parameters );\n\n        this.oldColor = this.color.clone();\n        this.oldOpacity = this.opacity;\n\n        this.highlight = function( highlighted ) {\n\n            if ( highlighted ) {\n\n                this.color.setRGB( 1, 230/255, 3/255 );\n                this.opacity = 1;\n\n            } else {\n\n                this.color.copy( this.oldColor );\n                this.opacity = this.oldOpacity;\n\n            }\n\n        };\n\n    };\n\n    GizmoLineMaterial.prototype = Object.create( THREE.LineBasicMaterial.prototype );\n\n    // polyfill\n    if (THREE.PolyhedronGeometry === undefined) {\n        THREE.PolyhedronGeometry = function ( vertices, indices, radius, detail ) {\n\n            THREE.Geometry.call( this );\n\n            this.type = 'PolyhedronGeometry';\n\n            this.parameters = {\n                vertices: vertices,\n                indices: indices,\n                radius: radius,\n                detail: detail\n            };\n\n            radius = radius || 1;\n            detail = detail || 0;\n\n            var that = this;\n\n            for ( var i = 0, l = vertices.length; i < l; i += 3 ) {\n\n                prepare( new THREE.Vector3( vertices[ i ], vertices[ i + 1 ], vertices[ i + 2 ] ) );\n\n            }\n\n            var midpoints = [], p = this.vertices;\n\n            var faces = [];\n\n            for ( var i = 0, j = 0, l = indices.length; i < l; i += 3, j ++ ) {\n\n                var v1 = p[ indices[ i     ] ];\n                var v2 = p[ indices[ i + 1 ] ];\n                var v3 = p[ indices[ i + 2 ] ];\n\n                faces[ j ] = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ] );\n\n            }\n\n            var centroid = new THREE.Vector3();\n\n            for ( var i = 0, l = faces.length; i < l; i ++ ) {\n\n                subdivide( faces[ i ], detail );\n\n            }\n\n\n            // Handle case when face straddles the seam\n\n            for ( var i = 0, l = this.faceVertexUvs[ 0 ].length; i < l; i ++ ) {\n\n                var uvs = this.faceVertexUvs[ 0 ][ i ];\n\n                var x0 = uvs[ 0 ].x;\n                var x1 = uvs[ 1 ].x;\n                var x2 = uvs[ 2 ].x;\n\n                var max = Math.max( x0, Math.max( x1, x2 ) );\n                var min = Math.min( x0, Math.min( x1, x2 ) );\n\n                if ( max > 0.9 && min < 0.1 ) { // 0.9 is somewhat arbitrary\n\n                    if ( x0 < 0.2 ) uvs[ 0 ].x += 1;\n                    if ( x1 < 0.2 ) uvs[ 1 ].x += 1;\n                    if ( x2 < 0.2 ) uvs[ 2 ].x += 1;\n\n                }\n\n            }\n\n\n            // Apply radius\n\n            for ( var i = 0, l = this.vertices.length; i < l; i ++ ) {\n\n                this.vertices[ i ].multiplyScalar( radius );\n\n            }\n\n\n            // Merge vertices\n\n            this.mergeVertices();\n\n            this.computeFaceNormals();\n\n            this.boundingSphere = new THREE.Sphere( new THREE.Vector3(), radius );\n\n\n            // Project vector onto sphere's surface\n\n            function prepare( vector ) {\n\n                var vertex = vector.normalize().clone();\n                vertex.index = that.vertices.push( vertex ) - 1;\n\n                // Texture coords are equivalent to map coords, calculate angle and convert to fraction of a circle.\n\n                var u = azimuth( vector ) / 2 / Math.PI + 0.5;\n                var v = inclination( vector ) / Math.PI + 0.5;\n                vertex.uv = new THREE.Vector2( u, 1 - v );\n\n                return vertex;\n\n            }\n\n\n            // Approximate a curved face with recursively sub-divided triangles.\n\n            function make( v1, v2, v3 ) {\n\n                var face = new THREE.Face3( v1.index, v2.index, v3.index, [ v1.clone(), v2.clone(), v3.clone() ] );\n                that.faces.push( face );\n\n                centroid.copy( v1 ).add( v2 ).add( v3 ).divideScalar( 3 );\n\n                var azi = azimuth( centroid );\n\n                that.faceVertexUvs[ 0 ].push( [\n                    correctUV( v1.uv, v1, azi ),\n                    correctUV( v2.uv, v2, azi ),\n                    correctUV( v3.uv, v3, azi )\n                ] );\n\n            }\n\n\n            // Analytically subdivide a face to the required detail level.\n\n            function subdivide( face, detail ) {\n\n                var cols = Math.pow(2, detail);\n                var cells = Math.pow(4, detail);\n                var a = prepare( that.vertices[ face.a ] );\n                var b = prepare( that.vertices[ face.b ] );\n                var c = prepare( that.vertices[ face.c ] );\n                var v = [];\n\n                // Construct all of the vertices for this subdivision.\n\n                for ( var i = 0 ; i <= cols; i ++ ) {\n\n                    v[ i ] = [];\n\n                    var aj = prepare( a.clone().lerp( c, i / cols ) );\n                    var bj = prepare( b.clone().lerp( c, i / cols ) );\n                    var rows = cols - i;\n\n                    for ( var j = 0; j <= rows; j ++) {\n\n                        if ( j == 0 && i == cols ) {\n\n                            v[ i ][ j ] = aj;\n\n                        } else {\n\n                            v[ i ][ j ] = prepare( aj.clone().lerp( bj, j / rows ) );\n\n                        }\n\n                    }\n\n                }\n\n                // Construct all of the faces.\n\n                for ( var i = 0; i < cols ; i ++ ) {\n\n                    for ( var j = 0; j < 2 * (cols - i) - 1; j ++ ) {\n\n                        var k = Math.floor( j / 2 );\n\n                        if ( j % 2 == 0 ) {\n\n                            make(\n                                v[ i ][ k + 1],\n                                v[ i + 1 ][ k ],\n                                v[ i ][ k ]\n                            );\n\n                        } else {\n\n                            make(\n                                v[ i ][ k + 1 ],\n                                v[ i + 1][ k + 1],\n                                v[ i + 1 ][ k ]\n                            );\n\n                        }\n\n                    }\n\n                }\n\n            }\n\n\n            // Angle around the Y axis, counter-clockwise when looking from above.\n\n            function azimuth( vector ) {\n\n                return Math.atan2( vector.z, - vector.x );\n\n            }\n\n\n            // Angle above the XZ plane.\n\n            function inclination( vector ) {\n\n                return Math.atan2( - vector.y, Math.sqrt( ( vector.x * vector.x ) + ( vector.z * vector.z ) ) );\n\n            }\n\n\n            // Texture fixing helper. Spheres have some odd behaviours.\n\n            function correctUV( uv, vector, azimuth ) {\n\n                if ( ( azimuth < 0 ) && ( uv.x === 1 ) ) uv = new THREE.Vector2( uv.x - 1, uv.y );\n                if ( ( vector.x === 0 ) && ( vector.z === 0 ) ) uv = new THREE.Vector2( azimuth / 2 / Math.PI + 0.5, uv.y );\n                return uv.clone();\n\n            }\n\n        };\n\n        THREE.PolyhedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\n    }\n\n    // polyfill\n    if (THREE.OctahedronGeometry === undefined) {\n        THREE.OctahedronGeometry = function ( radius, detail ) {\n\n            this.parameters = {\n                radius: radius,\n                detail: detail\n            };\n\n            var vertices = [\n                1, 0, 0,   - 1, 0, 0,    0, 1, 0,    0,- 1, 0,    0, 0, 1,    0, 0,- 1\n            ];\n\n            var indices = [\n                0, 2, 4,    0, 4, 3,    0, 3, 5,    0, 5, 2,    1, 2, 5,    1, 5, 3,    1, 3, 4,    1, 4, 2\n            ];\n\n            THREE.PolyhedronGeometry.call( this, vertices, indices, radius, detail );\n\n            this.type = 'OctahedronGeometry';\n\n            this.parameters = {\n                radius: radius,\n                detail: detail\n            };\n        };\n\n        THREE.OctahedronGeometry.prototype = Object.create( THREE.Geometry.prototype );\n    }\n\n    // polyfill\n    if (THREE.TorusGeometry === undefined) {\n        THREE.TorusGeometry = function ( radius, tube, radialSegments, tubularSegments, arc ) {\n\n            THREE.Geometry.call( this );\n\n            this.type = 'TorusGeometry';\n\n            this.parameters = {\n                radius: radius,\n                tube: tube,\n                radialSegments: radialSegments,\n                tubularSegments: tubularSegments,\n                arc: arc\n            };\n\n            radius = radius || 100;\n            tube = tube || 40;\n            radialSegments = radialSegments || 8;\n            tubularSegments = tubularSegments || 6;\n            arc = arc || Math.PI * 2;\n\n            var center = new THREE.Vector3(), uvs = [], normals = [];\n\n            for ( var j = 0; j <= radialSegments; j ++ ) {\n\n                for ( var i = 0; i <= tubularSegments; i ++ ) {\n\n                    var u = i / tubularSegments * arc;\n                    var v = j / radialSegments * Math.PI * 2;\n\n                    center.x = radius * Math.cos( u );\n                    center.y = radius * Math.sin( u );\n\n                    var vertex = new THREE.Vector3();\n                    vertex.x = ( radius + tube * Math.cos( v ) ) * Math.cos( u );\n                    vertex.y = ( radius + tube * Math.cos( v ) ) * Math.sin( u );\n                    vertex.z = tube * Math.sin( v );\n\n                    this.vertices.push( vertex );\n\n                    uvs.push( new THREE.Vector2( i / tubularSegments, j / radialSegments ) );\n                    normals.push( vertex.clone().sub( center ).normalize() );\n\n                }\n\n            }\n\n            for ( var j = 1; j <= radialSegments; j ++ ) {\n\n                for ( var i = 1; i <= tubularSegments; i ++ ) {\n\n                    var a = ( tubularSegments + 1 ) * j + i - 1;\n                    var b = ( tubularSegments + 1 ) * ( j - 1 ) + i - 1;\n                    var c = ( tubularSegments + 1 ) * ( j - 1 ) + i;\n                    var d = ( tubularSegments + 1 ) * j + i;\n\n                    var face = new THREE.Face3( a, b, d, [ normals[ a ].clone(), normals[ b ].clone(), normals[ d ].clone() ] );\n                    this.faces.push( face );\n                    this.faceVertexUvs[ 0 ].push( [ uvs[ a ].clone(), uvs[ b ].clone(), uvs[ d ].clone() ] );\n\n                    face = new THREE.Face3( b, c, d, [ normals[ b ].clone(), normals[ c ].clone(), normals[ d ].clone() ] );\n                    this.faces.push( face );\n                    this.faceVertexUvs[ 0 ].push( [ uvs[ b ].clone(), uvs[ c ].clone(), uvs[ d ].clone() ] );\n\n                }\n\n            }\n\n            this.computeFaceNormals();\n\n        };\n\n        THREE.TorusGeometry.prototype = Object.create( THREE.Geometry.prototype );\n    }\n\n    var createCircleGeometry = function ( radius, facing, arc ) {\n\n        var geometry = new THREE.Geometry();\n        arc = arc ? arc : 1;\n        for ( var i = 0; i <= 64 * arc; ++i ) {\n            if ( facing == 'x' ) geometry.vertices.push( new THREE.Vector3( 0, Math.cos( i / 32 * Math.PI ), Math.sin( i / 32 * Math.PI ) ).multiplyScalar(radius) );\n            if ( facing == 'y' ) geometry.vertices.push( new THREE.Vector3( Math.cos( i / 32 * Math.PI ), 0, Math.sin( i / 32 * Math.PI ) ).multiplyScalar(radius) );\n            if ( facing == 'z' ) geometry.vertices.push( new THREE.Vector3( Math.sin( i / 32 * Math.PI ), Math.cos( i / 32 * Math.PI ), 0 ).multiplyScalar(radius) );\n        }\n\n        return geometry;\n    };\n\n    var createArrowGeometry = function ( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded ) {\n\n        var arrowGeometry = new THREE.Geometry();\n        var mesh = new THREE.Mesh( new THREE.CylinderGeometry( radiusTop, radiusBottom, height, radialSegments, heightSegments, openEnded ) );\n        mesh.position.y = 0.5;\n        mesh.updateMatrix();\n\n        arrowGeometry.merge( mesh.geometry, mesh.matrix );\n\n        return arrowGeometry;\n    };\n\n    var createLineGeometry = function ( axis ) {\n\n        var lineGeometry = new THREE.Geometry();\n        if ( axis === 'X') \n            lineGeometry.vertices.push( new THREE.Vector3( 0, 0, 0 ), new THREE.Vector3( 1, 0, 0 ) );\n        else if ( axis === 'Y' ) \n            lineGeometry.vertices.push( new THREE.Vector3( 0, 0, 0 ), new THREE.Vector3( 0, 1, 0 ) );\n        else if ( axis === 'Z' )\n            lineGeometry.vertices.push( new THREE.Vector3( 0, 0, 0 ), new THREE.Vector3( 0, 0, 1 ) );\n\n        return lineGeometry;\n    };\n\n    THREE.TransformGizmo = function (includeAxis) {\n\n        var scope = this;\n        var showPickers = false; //debug\n        var showActivePlane = false; //debug\n\n        this.init = function () {\n\n            THREE.Object3D.call( this );\n\n            this.handles = new THREE.Object3D();\n            this.pickers = new THREE.Object3D();\n            this.planes = new THREE.Object3D();\n            this.highlights = new THREE.Object3D();\n            this.hemiPicker = new THREE.Object3D();\n            this.subPickers = new THREE.Object3D();\n\n            this.add(this.handles);\n            this.add(this.pickers);\n            this.add(this.planes);\n            this.add(this.highlights);\n            this.add(this.hemiPicker);\n            this.add(this.subPickers);\n\n            //// PLANES\n\n            var planeGeometry = new THREE.PlaneBufferGeometry( 50, 50, 2, 2 );\n            var planeMaterial = new THREE.MeshBasicMaterial( { wireframe: true } );\n            planeMaterial.side = THREE.DoubleSide;\n\n            var planes = {\n                \"XY\":   new THREE.Mesh( planeGeometry, planeMaterial ),\n                \"YZ\":   new THREE.Mesh( planeGeometry, planeMaterial ),\n                \"XZ\":   new THREE.Mesh( planeGeometry, planeMaterial ),\n                \"XYZE\": new THREE.Mesh( planeGeometry, planeMaterial )\n            };\n\n            this.activePlane = planes[\"XYZE\"];\n\n            planes[\"YZ\"].rotation.set( 0, Math.PI/2, 0 );\n            planes[\"XZ\"].rotation.set( -Math.PI/2, 0, 0 );\n\n            for (var i in planes) {\n                planes[i].name = i;\n                this.planes.add(planes[i]);\n                this.planes[i] = planes[i];\n                planes[i].visible = false;\n            }\n\n            this.setupGizmos();\n            this.activeMode = \"\";\n\n            // reset Transformations\n\n            this.traverse(function ( child ) {\n                if (child instanceof THREE.Mesh) {\n                    child.updateMatrix();\n\n                    var tempGeometry = new THREE.Geometry();\n                    if (child.geometry instanceof THREE.BufferGeometry) {\n                        child.geometry = new THREE.Geometry().fromBufferGeometry( child.geometry );\n                    }\n                    tempGeometry.merge( child.geometry, child.matrix );\n\n                    child.geometry = tempGeometry;\n                    child.position.set( 0, 0, 0 );\n                    child.rotation.set( 0, 0, 0 );\n                    child.scale.set( 1, 1, 1 );\n                }\n            });\n\n        };\n\n        this.hide = function () {\n            this.traverse(function( child ) {\n                child.visible = false;\n            });\n        };\n\n        this.show = function () {\n            this.traverse(function( child ) {\n                child.visible = true;\n                if (child.parent == scope.pickers || child.parent == scope.hemiPicker ) child.visible = showPickers;\n                if (child.parent == scope.planes ) child.visible = false;\n            });\n            this.activePlane.visible = showActivePlane;\n        };\n\n        this.highlight = function ( axis ) {\n            this.traverse(function( child ) {\n                if ( child.material && child.material.highlight ) {\n                    if ( child.name == axis ) {\n                        child.material.highlight( true );\n                    } else {\n                        child.material.highlight( false );\n                    }\n                }\n            });\n        };\n\n        this.setupGizmos = function () {\n\n            var addGizmos = function( gizmoMap, parent ) {\n\n                for ( var name in gizmoMap ) {\n\n                    for ( var i = gizmoMap[name].length; i--;) {\n\n                        var object = gizmoMap[name][i][0];\n                        var position = gizmoMap[name][i][1];\n                        var rotation = gizmoMap[name][i][2];\n                        var visble = gizmoMap[name][i][3];\n\n                        object.name = name;\n\n                        if ( position ) object.position.set( position[0], position[1], position[2] );\n                        if ( rotation ) object.rotation.set( rotation[0], rotation[1], rotation[2] );\n                        if ( visble ) object.visble = visble;\n\n                        parent.add( object );\n\n                    }\n\n                }\n\n            };\n\n            this.setHandlePickerGizmos();\n\n            if (includeAxis) {\n                var axisNames = Object.keys(this.handleGizmos);\n\n                for (var i = 0; i < axisNames.length; i++) {\n                    var axisName = axisNames[i];\n\n                    if (includeAxis.indexOf(axisName) === -1) {\n                        delete this.handleGizmos[axisName];\n                        delete this.pickerGizmos[axisName];\n                        delete this.hemiPickerGizmos[axisName];\n                    }\n                }\n            }\n\n            addGizmos(this.handleGizmos, this.handles);\n            addGizmos(this.pickerGizmos, this.pickers);\n            addGizmos(this.highlightGizmos, this.highlights);\n            addGizmos(this.hemiPickerGizmos, this.hemiPicker);\n            addGizmos(this.subPickerGizmos, this.subPickers);\n\n            this.hide();\n            this.show();\n\n        };\n\n    };\n\n    THREE.TransformGizmo.prototype = Object.create( THREE.Object3D.prototype );\n\n    THREE.TransformGizmo.prototype.update = function ( rotation, eye ) {\n\n        var vec1 = new THREE.Vector3( 0, 0, 0 );\n        var vec2 = new THREE.Vector3( 0, 1, 0 );\n        var lookAtMatrix = new THREE.Matrix4();\n\n        this.traverse(function(child) {\n            if ( child.name ) {\n                if ( child.name.search(\"E\") != -1 ) {\n                    child.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( eye, vec1, vec2 ) );\n                } else if ( child.name.search(\"X\") != -1 || child.name.search(\"Y\") != -1 || child.name.search(\"Z\") != -1 ) {\n                    child.quaternion.setFromEuler( rotation );\n                }\n            }\n        });\n\n    };\n\n    THREE.TransformGizmoTranslate = function (includeAxis) {\n\n        THREE.TransformGizmo.call( this, includeAxis );\n\n        this.setHandlePickerGizmos = function () {\n\n            var arrowGeometry = createArrowGeometry( 0, 0.05, 0.2, 12, 1, false );\n            var lineXGeometry = createLineGeometry( 'X' );\n            var lineYGeometry = createLineGeometry( 'Y' );\n            var lineZGeometry = createLineGeometry( 'Z' );\n\n            this.handleGizmos = {\n                X: [\n                    [ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0xf12c2c } ) ), [ 0.5, 0, 0 ], [ 0, 0, -Math.PI/2 ] ],\n                    [ new THREE.Line( lineXGeometry, new GizmoLineMaterial( { color: 0xf12c2c } ) ) ]\n                ],\n                Y: [\n                    [ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0x0bb80b } ) ), [ 0, 0.5, 0 ] ],\n                    [   new THREE.Line( lineYGeometry, new GizmoLineMaterial( { color: 0x0bb80b } ) ) ]\n                ],\n                Z: [\n                    [ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0x2c2cf1 } ) ), [ 0, 0, 0.5 ], [ Math.PI/2, 0, 0 ] ],\n                    [ new THREE.Line( lineZGeometry, new GizmoLineMaterial( { color: 0x2c2cf1 } ) ) ]\n                ],\n                XYZ: [\n                    [ new THREE.Mesh( new THREE.OctahedronGeometry( 0.1, 0 ), new GizmoMaterial( { color: 0xffffff, opacity: 0.25 } ) ), [ 0, 0, 0 ], [ 0, 0, 0 ] ]\n                ],\n                XY: [\n                    [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.29, 0.29 ), new GizmoMaterial( { color: 0xffff00, opacity: 0.25 } ) ), [ 0.15, 0.15, 0 ] ]\n                ],\n                YZ: [\n                    [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.29, 0.29 ), new GizmoMaterial( { color: 0x00ffff, opacity: 0.25 } ) ), [ 0, 0.15, 0.15 ], [ 0, Math.PI/2, 0 ] ]\n                ],\n                XZ: [\n                    [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.29, 0.29 ), new GizmoMaterial( { color: 0xff00ff, opacity: 0.25 } ) ), [ 0.15, 0, 0.15 ], [ -Math.PI/2, 0, 0 ] ]\n                ]\n            };\n\n            this.pickerGizmos = {\n                X: [\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.2, 0, 1, 4, 1, false ), new GizmoMaterial( { color: 0xff0000, opacity: 0.25 } ) ), [ 0.6, 0, 0 ], [ 0, 0, -Math.PI/2 ] ]\n                ],\n                Y: [\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.2, 0, 1, 4, 1, false ), new GizmoMaterial( { color: 0x00ff00, opacity: 0.25 } ) ), [ 0, 0.6, 0 ] ]\n                ],\n                Z: [\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.2, 0, 1, 4, 1, false ), new GizmoMaterial( { color: 0x0000ff, opacity: 0.25 } ) ), [ 0, 0, 0.6 ], [ Math.PI/2, 0, 0 ] ]\n                ],\n                XYZ: [\n                    [ new THREE.Mesh( new THREE.OctahedronGeometry( 0.2, 0 ), new GizmoMaterial( { color: 0xffffff, opacity: 0.25 } ) ) ]\n                ],\n                XY: [\n                    [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), new GizmoMaterial( { color: 0xffff00, opacity: 0.25 } ) ), [ 0.2, 0.2, 0 ] ]\n                ],\n                YZ: [\n                    [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), new GizmoMaterial( { color: 0x00ffff, opacity: 0.25 } ) ), [ 0, 0.2, 0.2 ], [ 0, Math.PI/2, 0 ] ]\n                ],\n                XZ: [\n                    [ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), new GizmoMaterial( { color: 0xff00ff, opacity: 0.25 } ) ), [ 0.2, 0, 0.2 ], [ -Math.PI/2, 0, 0 ] ]\n                ]\n            };\n\n            this.hemiPickerGizmos = {\n                XYZ: [\n                    [ new THREE.Mesh( new THREE.BoxGeometry( 1.2, 1.2, 1.2 ), new GizmoMaterial( { color: 0x0000ff } ) ), [ 0.5, 0.5, 0.5 ], null, false ]\n                ]\n            };\n\n        };\n\n        this.setActivePlane = function ( axis, eye, isLocalSpace ) {\n\n            var tempMatrix = new THREE.Matrix4();\n            eye.applyMatrix4( tempMatrix.getInverse( tempMatrix.extractRotation( this.planes[ \"XY\" ].matrixWorld ) ) );\n\n            if ( axis == \"X\" ) {\n                this.activePlane = this.planes[ \"XY\" ];\n                if ( !isLocalSpace && Math.abs(eye.y) > Math.abs(eye.z) ) this.activePlane = this.planes[ \"XZ\" ];\n            }\n\n            if ( axis == \"Y\" ){\n                this.activePlane = this.planes[ \"XY\" ];\n                if ( !isLocalSpace && Math.abs(eye.x) > Math.abs(eye.z) ) this.activePlane = this.planes[ \"YZ\" ];\n            }\n\n            if ( axis == \"Z\" ){\n                this.activePlane = this.planes[ \"XZ\" ];\n                if ( !isLocalSpace && Math.abs(eye.x) > Math.abs(eye.y) ) this.activePlane = this.planes[ \"YZ\" ];\n            }\n\n            if ( axis == \"XYZ\" ) this.activePlane = this.planes[ \"XYZE\" ];\n\n            if ( axis == \"XY\" ) this.activePlane = this.planes[ \"XY\" ];\n\n            if ( axis == \"YZ\" ) this.activePlane = this.planes[ \"YZ\" ];\n\n            if ( axis == \"XZ\" ) this.activePlane = this.planes[ \"XZ\" ];\n\n            this.hide();\n            this.show();\n\n        };\n\n        this.init();\n\n    };\n\n    THREE.TransformGizmoTranslate.prototype = Object.create( THREE.TransformGizmo.prototype );\n\n    THREE.TransformGizmoRotate = function (includeAxis) {\n\n        THREE.TransformGizmo.call( this, includeAxis );\n\n        this.setHandlePickerGizmos = function () {\n\n            this.handleGizmos = {\n                RX: [\n                    [ new THREE.Line( createCircleGeometry(1,'x',0.5), new GizmoLineMaterial( { color: 0xff0000 } ) ) ]\n                ],\n                RY: [\n                    [ new THREE.Line( createCircleGeometry(1,'y',0.5), new GizmoLineMaterial( { color: 0x00ff00 } ) ) ]\n                ],\n                RZ: [\n                    [ new THREE.Line( createCircleGeometry(1,'z',0.5), new GizmoLineMaterial( { color: 0x0000ff } ) ) ]\n                ],\n                RE: [\n                    [ new THREE.Line( createCircleGeometry(1.25,'z',1), new GizmoLineMaterial( { color: 0x00ffff } ) ) ]\n                ],\n                RXYZE: [\n                    [ new THREE.Line( createCircleGeometry(1,'z',1), new GizmoLineMaterial( { color: 0xff00ff } ) ) ]\n                ]\n            };\n\n            this.pickerGizmos = {\n                RX: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1, 0.12, 4, 12, Math.PI ), new GizmoMaterial( { color: 0xff0000, opacity: 0.25 } ) ), [ 0, 0, 0 ], [ 0, -Math.PI/2, -Math.PI/2 ] ]\n                ],\n                RY: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1, 0.12, 4, 12, Math.PI ), new GizmoMaterial( { color: 0x00ff00, opacity: 0.25 } ) ), [ 0, 0, 0 ], [ Math.PI/2, 0, 0 ] ]\n                ],\n                RZ: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1, 0.12, 4, 12, Math.PI ), new GizmoMaterial( { color: 0x0000ff, opacity: 0.25 } ) ), [ 0, 0, 0 ], [ 0, 0, -Math.PI/2 ] ]\n                ],\n                RE: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1.25, 0.12, 2, 24 ), new GizmoMaterial( { color: 0x00ffff, opacity: 0.25 } ) ) ]\n                ],\n                RXYZE: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1, 0.12, 2, 24 ), new GizmoMaterial( { color: 0xff00ff, opacity: 0.25 } ) ) ]\n                ]\n            };\n\n        };\n\n        this.setActivePlane = function ( axis ) {\n\n            if ( axis == \"RE\" ) this.activePlane = this.planes[ \"XYZE\" ];\n\n            if ( axis == \"RX\" ) this.activePlane = this.planes[ \"YZ\" ];\n\n            if ( axis == \"RY\" ) this.activePlane = this.planes[ \"XZ\" ];\n\n            if ( axis == \"RZ\" ) this.activePlane = this.planes[ \"XY\" ];\n\n            this.hide();\n            this.show();\n\n        };\n\n        this.update = function ( rotation, eye2 ) {\n\n            THREE.TransformGizmo.prototype.update.apply( this, arguments );\n\n            var tempMatrix = new THREE.Matrix4();\n            var worldRotation = new THREE.Euler( 0, 0, 1 );\n            var tempQuaternion = new THREE.Quaternion();\n            var unitX = new THREE.Vector3( 1, 0, 0 );\n            var unitY = new THREE.Vector3( 0, 1, 0 );\n            var unitZ = new THREE.Vector3( 0, 0, 1 );\n            var quaternionX = new THREE.Quaternion();\n            var quaternionY = new THREE.Quaternion();\n            var quaternionZ = new THREE.Quaternion();\n            var eye = eye2.clone();\n\n            worldRotation.copy( this.planes[\"XY\"].rotation );\n            tempQuaternion.setFromEuler( worldRotation );\n\n            tempMatrix.makeRotationFromQuaternion( tempQuaternion ).getInverse( tempMatrix );\n            eye.applyMatrix4( tempMatrix );\n\n            this.traverse(function(child) {\n\n                tempQuaternion.setFromEuler( worldRotation );\n\n                if ( child.name == \"RX\" ) {\n                    quaternionX.setFromAxisAngle( unitX, Math.atan2( -eye.y, eye.z ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionX );\n                    child.quaternion.copy( tempQuaternion );\n                }\n\n                if ( child.name == \"RY\" ) {\n                    quaternionY.setFromAxisAngle( unitY, Math.atan2( eye.x, eye.z ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionY );\n                    child.quaternion.copy( tempQuaternion );\n                }\n\n                if ( child.name == \"RZ\" ) {\n                    quaternionZ.setFromAxisAngle( unitZ, Math.atan2( eye.y, eye.x ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionZ );\n                    child.quaternion.copy( tempQuaternion );\n                }\n\n            });\n\n        };\n\n        this.init();\n\n    };\n\n    THREE.TransformGizmoRotate.prototype = Object.create( THREE.TransformGizmo.prototype );\n\n    THREE.TransformGizmoTranslateRotate = function (includeAxis) {\n\n        THREE.TransformGizmo.call( this, includeAxis );\n\n        var scope = this;\n\n        this.setHandlePickerGizmos = function () {\n\n            var arrowGeometry = createArrowGeometry( 0, 0.05, 0.2, 12, 1, false );\n            var lineGeometry = new THREE.Geometry();\n            lineGeometry.vertices.push( new THREE.Vector3( 0, 0, -0.1 ), new THREE.Vector3( 0, 0, 0.1 ), new THREE.Vector3( -0.1, 0, 0 ), new THREE.Vector3( 0.1, 0, 0 ) );\n            var theta = 0.15;\n\n            this.handleGizmos = {\n                Z: [\n                    [ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0xffffff } ) ), [ 0, 0, 0.25 ], [ Math.PI/2, 0, 0 ] ],\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.015, 0.015, 0.6, 4, 1, false ), new GizmoMaterial( { color: 0xffffff } ) ), [ 0, 0, 0.5 ],[ Math.PI/2, 0, 0 ] ]\n                ],\n                RX: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1, 0.015, 12, 60, theta * 2 * Math.PI ), new GizmoMaterial( { color: 0xff0000 } ) ), [ 0, 0, 0 ], [ theta * Math.PI, -Math.PI/2, 0 ] ],\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.05, 0.05, 0.015, 60, 1, false ), new GizmoMaterial( { color: 0xff0000 } ) ), [ 0, 0, 1 ], [ Math.PI/2, 0, 0 ] ]\n                ],\n                RY: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1, 0.015, 12, 60, theta * 2 * Math.PI ), new GizmoMaterial( { color: 0x0000ff } ) ), [ 0, 0, 0 ], [ Math.PI/2, 0, (0.5-theta)*Math.PI ] ],\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.05, 0.05, 0.01, 60, 1, false ), new GizmoMaterial( { color: 0x0000ff } ) ), [ 0, 0, 1 ] ]\n                ]\n            };\n\n            this.pickerGizmos = {\n                Z: [\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.12, 0.12, 0.65, 4, 1, false ), new GizmoMaterial( { color: 0x0000ff, opacity: 0.25 } ) ), [ 0, 0, 0.5 ], [ Math.PI/2, 0, 0 ] ]\n                ],\n                RX: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1, 0.12, 4, 12, theta * 2 * Math.PI ), new GizmoMaterial( { color: 0xff0000, opacity: 0.25 } ) ), [ 0, 0, 0 ], [ theta * Math.PI, -Math.PI/2, 0 ] ]\n                ],\n                RY: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1, 0.12, 4, 12, theta * 2 * Math.PI ), new GizmoMaterial( { color: 0x0000ff, opacity: 0.25 } ) ), [ 0, 0, 0 ], [ Math.PI/2, 0, (0.5-theta)*Math.PI ] ]\n                ]\n            };\n\n            this.subPickerGizmos = {\n                Z: [\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.12, 0.12, 0.65, 4, 1, false ), new GizmoMaterial( { color: 0x0000ff, opacity: 0.25 } ) ), [ 0, 0, 0.5 ], [ Math.PI/2, 0, 0 ] ]\n                ]\n            };\n\n            this.highlightGizmos = {\n                Z: [\n                ],\n                RX: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1, 0.02, 12, 60, 2 * Math.PI ), new GizmoMaterial( { color: 0xff0000, opacity: 1 } ) ), [ 0, 0, 0 ], [ 0, -Math.PI/2, -Math.PI/2 ], false ]\n                ],\n                RY: [\n                    [ new THREE.Mesh( new THREE.TorusGeometry( 1, 0.02, 12, 60, 2 * Math.PI ), new GizmoMaterial( { color: 0x0000ff, opacity: 1 } ) ), [ 0, 0, 0 ], [ Math.PI/2, 0, 0 ], false ]\n                ]\n            };\n\n            this.hemiPickerGizmos = {\n                XYZ: [\n                    [ new THREE.Mesh( new THREE.SphereGeometry( 1.2, 8, 8, 0, Math.PI ), new GizmoMaterial( { color: 0x0000ff } ) ), null, null, false ]\n                ]\n            };\n\n        };\n\n        this.setActivePlane = function ( axis, eye, isLocalSpace ) {\n\n            if ( this.activeMode == \"translate\" ) {\n\n                var tempMatrix = new THREE.Matrix4();\n                eye.applyMatrix4( tempMatrix.getInverse( tempMatrix.extractRotation( this.planes[ \"XY\" ].matrixWorld ) ) );\n\n                if ( axis == \"X\" ) {\n                    this.activePlane = this.planes[ \"XY\" ];\n                    if ( !isLocalSpace && Math.abs(eye.y) > Math.abs(eye.z) ) this.activePlane = this.planes[ \"XZ\" ];\n                }\n\n                if ( axis == \"Y\" ){\n                    this.activePlane = this.planes[ \"XY\" ];\n                    if ( !isLocalSpace && Math.abs(eye.x) > Math.abs(eye.z) ) this.activePlane = this.planes[ \"YZ\" ];\n                }\n\n                if ( axis == \"Z\" ){\n                    this.activePlane = this.planes[ \"XZ\" ];\n                    if ( !isLocalSpace && Math.abs(eye.x) > Math.abs(eye.y) ) this.activePlane = this.planes[ \"YZ\" ];\n                }\n\n            } else if ( this.activeMode == \"rotate\" ){\n\n                if ( axis == \"RX\" ) this.activePlane = this.planes[ \"YZ\" ];\n\n                if ( axis == \"RY\" ) this.activePlane = this.planes[ \"XZ\" ];\n\n                if ( axis == \"RZ\" ) this.activePlane = this.planes[ \"XY\" ];\n\n            }\n\n            this.hide();\n            this.show();\n\n        };\n\n        this.update = function ( rotation, eye2 ) {\n\n            if ( this.activeMode == \"translate\" ) {\n\n                THREE.TransformGizmo.prototype.update.apply( this, arguments );\n\n            } else if ( this.activeMode == \"rotate\" ) {\n\n                THREE.TransformGizmo.prototype.update.apply( this, arguments );\n\n                var tempMatrix = new THREE.Matrix4();\n                var worldRotation = new THREE.Euler( 0, 0, 1 );\n                var tempQuaternion = new THREE.Quaternion();\n                var unitX = new THREE.Vector3( 1, 0, 0 );\n                var unitY = new THREE.Vector3( 0, 1, 0 );\n                var unitZ = new THREE.Vector3( 0, 0, 1 );\n                var quaternionX = new THREE.Quaternion();\n                var quaternionY = new THREE.Quaternion();\n                var quaternionZ = new THREE.Quaternion();\n                var eye = eye2.clone();\n\n                worldRotation.copy( this.planes[\"XY\"].rotation );\n                tempQuaternion.setFromEuler( worldRotation );\n\n                tempMatrix.makeRotationFromQuaternion( tempQuaternion ).getInverse( tempMatrix );\n                eye.applyMatrix4( tempMatrix );\n\n                this.traverse(function(child) {\n\n                    tempQuaternion.setFromEuler( worldRotation );\n\n                    if ( child.name == \"RX\" ) {\n                        quaternionX.setFromAxisAngle( unitX, Math.atan2( -eye.y, eye.z ) );\n                        tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionX );\n                        child.quaternion.copy( tempQuaternion );\n                    }\n\n                    if ( child.name == \"RY\" ) {\n                        quaternionY.setFromAxisAngle( unitY, Math.atan2( eye.x, eye.z ) );\n                        tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionY );\n                        child.quaternion.copy( tempQuaternion );\n                    }\n\n                    if ( child.name == \"RZ\" ) {\n                        quaternionZ.setFromAxisAngle( unitZ, Math.atan2( eye.y, eye.x ) );\n                        tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionZ );\n                        child.quaternion.copy( tempQuaternion );\n                    }\n\n                });\n\n            }\n\n        };\n\n        this.show = function () {\n            this.traverse(function( child ) {\n                if ( scope.parent == null || (scope.parent.useAllPickers || child.parent != scope.handles) ) child.visible = true;\n                if ( child.material ) child.material.opacity = child.material.oldOpacity;\n                if ( child.parent == scope.pickers || child.parent == scope.hemiPicker || child.parent == scope.subPickers) child.visible = false;\n                if ( child.parent == scope.planes || child.parent == scope.highlights ) child.visible = false;\n            });\n            this.activePlane.visible = false;\n        };\n\n        this.highlight = function ( axis ) {\n            this.traverse(function( child ) {\n                if ( child.material && child.material.highlight ) {\n                    if ( child.name == axis ) {\n                        if ( child.parent == scope.highlights || child.parent == scope.handles ) child.visible = true;\n                        child.material.highlight( true );\n                    } else {\n                        child.material.highlight( false );\n                        child.material.opacity = 0.1;\n                    }\n                }\n            });\n        };\n\n        this.init();\n\n    };\n\n    THREE.TransformGizmoTranslateRotate.prototype = Object.create( THREE.TransformGizmo.prototype );\n\n    THREE.TransformGizmoScale = function (includeAxis) {\n\n        THREE.TransformGizmo.call( this, includeAxis );\n\n        this.setHandlePickerGizmos = function () {\n\n            var arrowGeometry = createArrowGeometry( 0.125, 0.125, 0.125 );\n            var lineXGeometry = createLineGeometry( 'X' );\n            var lineYGeometry = createLineGeometry( 'Y' );\n            var lineZGeometry = createLineGeometry( 'Z' );\n\n            this.handleGizmos = {\n                X: [\n                    [ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0xff0000 } ) ), [ 0.5, 0, 0 ], [ 0, 0, -Math.PI/2 ] ],\n                    [ new THREE.Line( lineXGeometry, new GizmoLineMaterial( { color: 0xff0000 } ) ) ]\n                ],\n                Y: [\n                    [ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0x00ff00 } ) ), [ 0, 0.5, 0 ] ],\n                    [ new THREE.Line( lineYGeometry, new GizmoLineMaterial( { color: 0x00ff00 } ) ) ]\n                ],\n                Z: [\n                    [ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0x0000ff } ) ), [ 0, 0, 0.5 ], [ Math.PI/2, 0, 0 ] ],\n                    [ new THREE.Line( lineZGeometry, new GizmoLineMaterial( { color: 0x0000ff } ) ) ]\n                ],\n                XYZ: [\n                    [ new THREE.Mesh( new THREE.BoxGeometry( 0.125, 0.125, 0.125 ), new GizmoMaterial( { color: 0xffffff, opacity: 0.25 } ) ) ]\n                ]\n            };\n\n            this.pickerGizmos = {\n                X: [\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.2, 0, 1, 4, 1, false ), new GizmoMaterial( { color: 0xff0000, opacity: 0.25 } ) ), [ 0.6, 0, 0 ], [ 0, 0, -Math.PI/2 ] ]\n                ],\n                Y: [\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.2, 0, 1, 4, 1, false ), new GizmoMaterial( { color: 0x00ff00, opacity: 0.25 } ) ), [ 0, 0.6, 0 ] ]\n                ],\n                Z: [\n                    [ new THREE.Mesh( new THREE.CylinderGeometry( 0.2, 0, 1, 4, 1, false ), new GizmoMaterial( { color: 0x0000ff, opacity: 0.25 } ) ), [ 0, 0, 0.6 ], [ Math.PI/2, 0, 0 ] ]\n                ],\n                XYZ: [\n                    [ new THREE.Mesh( new THREE.BoxGeometry( 0.4, 0.4, 0.4 ), new GizmoMaterial( { color: 0xffffff, opacity: 0.25 } ) ) ]\n                ]\n            };\n\n        };\n\n        this.setActivePlane = function ( axis, eye, isLocalSpace ) {\n\n            var tempMatrix = new THREE.Matrix4();\n            eye.applyMatrix4( tempMatrix.getInverse( tempMatrix.extractRotation( this.planes[ \"XY\" ].matrixWorld ) ) );\n\n            if ( axis == \"X\" ) {\n                this.activePlane = this.planes[ \"XY\" ];\n                if ( !isLocalSpace && Math.abs(eye.y) > Math.abs(eye.z) ) this.activePlane = this.planes[ \"XZ\" ];\n            }\n\n            if ( axis == \"Y\" ){\n                this.activePlane = this.planes[ \"XY\" ];\n                if ( !isLocalSpace && Math.abs(eye.x) > Math.abs(eye.z) ) this.activePlane = this.planes[ \"YZ\" ];\n            }\n\n            if ( axis == \"Z\" ){\n                this.activePlane = this.planes[ \"XZ\" ];\n                if ( !isLocalSpace && Math.abs(eye.x) > Math.abs(eye.y) ) this.activePlane = this.planes[ \"YZ\" ];\n            }\n\n            if ( axis == \"XYZ\" ) this.activePlane = this.planes[ \"XYZE\" ];\n\n            this.hide();\n            this.show();\n\n        };\n\n        this.init();\n\n    };\n\n    THREE.TransformGizmoScale.prototype = Object.create( THREE.TransformGizmo.prototype );\n\n    THREE.TransformControls = function ( camera, domElement, mode, includeAxis ) {\n\n        // TODO: Make non-uniform scale and rotate play nice in hierarchies\n        // TODO: ADD RXYZ contol\n\n        THREE.Object3D.call( this );\n\n        domElement = ( domElement !== undefined ) ? domElement : document;\n\n        this.gizmo = {};\n        switch ( mode ) {\n            case \"translate\":\n                this.gizmo[mode] = new THREE.TransformGizmoTranslate(includeAxis);\n                break;\n            case \"rotate\":           \n               this.gizmo[mode] = new THREE.TransformGizmoRotate(includeAxis);\n               break;\n            case \"transrotate\":\n                this.gizmo[mode] = new THREE.TransformGizmoTranslateRotate(includeAxis);\n                break;\n            case \"scale\":\n                this.gizmo[mode] = new THREE.TransformGizmoScale(includeAxis);\n                break;\n        }\n\n        this.add(this.gizmo[mode]);\n        this.gizmo[mode].hide();\n\n        this.object = undefined;\n        this.snap = null;\n        this.snapDelta = 0;\n        this.space = \"world\";\n        this.size = 1;\n        this.axis = null;\n        this.useAllPickers = true;\n\n        this.unitX = new THREE.Vector3( 1, 0, 0 );\n        this.unitY = new THREE.Vector3( 0, 1, 0 );\n        this.unitZ = new THREE.Vector3( 0, 0, 1 );\n        this.normal = new THREE.Vector3(0, 0, 1);\n\n        if ( mode === \"transrotate\" ) {\n            var geometry = new THREE.Geometry();\n            geometry.vertices.push( new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, 1) );\n            var material = new THREE.LineBasicMaterial( {color: 0x000000, linewidth:2, depthTest: false} );\n            this.startLine = new THREE.Line( geometry, material );\n            var geometry = new THREE.Geometry();\n            var material = new THREE.LineBasicMaterial( {color: 0xffe603, linewidth:2, depthTest: false} );\n            geometry.vertices.push( new THREE.Vector3(0, 0, 0), new THREE.Vector3(0, 0, 1) );\n            this.endLine = new THREE.Line( geometry, material );\n            var geometry = new THREE.Geometry();\n            var material = new THREE.LineDashedMaterial({color: 0x000000, linewidth:1, depthTest: false});\n            geometry.vertices.push( new THREE.Vector3(0, -1, 0), new THREE.Vector3(0, 1, 0) );\n            this.centerLine = new THREE.Line( geometry, material );\n\n            var map = THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl(\"res/textures/centerMarker_X.png\"));\n            map.magFilter = map.minFilter = THREE.NearestFilter;\n            var geometry = new THREE.CircleGeometry( 0.1, 32 );\n            var material = new THREE.MeshBasicMaterial({opacity: 1, side: THREE.DoubleSide, transparent:true, map:map});\n            this.centerMark = new THREE.Mesh( geometry, material );\n            this.centerMark.rotation.set(Math.PI/2, 0, 0);\n\n            this.ticks = {};\n            var map = THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl(\"res/textures/cardinalPoint.png\"));\n            map.magFilter = map.minFilter = THREE.NearestFilter;\n            var material = new THREE.MeshBasicMaterial({depthTest: false, opacity: 1, transparent:true, side: THREE.DoubleSide, map:map});\n            var w = 0.12, h = 0.25, d = 1.15;\n\n            this.ticks[\"RX\"] = new THREE.Object3D();\n            var geometry = new THREE.PlaneBufferGeometry(w, h);\n            var mesh = new THREE.Mesh(geometry, material);\n            mesh.position.set(0, 0, -d-h/2);\n            mesh.rotation.set(Math.PI/2, Math.PI/2, 0);\n            this.ticks[\"RX\"].add(mesh);\n\n            mesh = mesh.clone();\n            mesh.position.set(0, d+h/2, 0);\n            mesh.rotation.set(0, Math.PI/2, 0);\n            this.ticks[\"RX\"].add(mesh);\n\n            mesh = mesh.clone();\n            mesh.position.set(0, 0, d+h/2);\n            mesh.rotation.set(0, Math.PI/2, Math.PI/2);\n            this.ticks[\"RX\"].add(mesh);\n\n            mesh = mesh.clone();\n            mesh.position.set(0, -d-h/2, 0);\n            mesh.rotation.set(0, Math.PI/2, 0);\n            this.ticks[\"RX\"].add(mesh);\n\n            this.ticks[\"RY\"] = new THREE.Object3D();\n            mesh = mesh.clone();\n            mesh.position.set(0, 0, -d-h/2);\n            mesh.rotation.set(Math.PI/2, 0, 0);\n            this.ticks[\"RY\"].add(mesh);\n\n            mesh = mesh.clone();\n            mesh.position.set(-d-h/2, 0, 0);\n            mesh.rotation.set(Math.PI/2, 0, Math.PI/2);\n            this.ticks[\"RY\"].add(mesh);\n\n            mesh = mesh.clone();\n            mesh.position.set(0, 0, d+h/2);\n            mesh.rotation.set(Math.PI/2, 0, 0);\n            this.ticks[\"RY\"].add(mesh);\n\n            mesh = mesh.clone();\n            mesh.position.set(d+h/2, 0, 0);\n            mesh.rotation.set(Math.PI/2, 0, Math.PI/2);\n            this.ticks[\"RY\"].add(mesh);\n        }\n\n        var scope = this;\n\n        var _dragging = false;\n        var _mode = mode;\n        var _plane = \"XY\";\n\n        var changeEvent = { type: \"change\" };\n        var mouseDownEvent = { type: \"mouseDown\" };\n        var mouseUpEvent = { type: \"mouseUp\", mode: _mode };\n        var objectChangeEvent = { type: \"objectChange\" };\n\n        var ray = new THREE.Raycaster();\n        var pointerVector = new THREE.Vector3();\n        var pointerDir = new THREE.Vector3();\n\n        var point = new THREE.Vector3();\n        var offset = new THREE.Vector3();\n\n        var rotation = new THREE.Vector3();\n        var offsetRotation = new THREE.Vector3();\n        var scale = 1;\n        this.clientScale = 1;\n\n        var lookAtMatrix = new THREE.Matrix4();\n        var eye = new THREE.Vector3();\n\n        var tempMatrix = new THREE.Matrix4();\n        var tempVector = new THREE.Vector3();\n        var tempQuaternion = new THREE.Quaternion();\n        var projX = new THREE.Vector3();\n        var projY = new THREE.Vector3();\n        var projZ = new THREE.Vector3();\n\n        var quaternionXYZ = new THREE.Quaternion();\n        var quaternionX = new THREE.Quaternion();\n        var quaternionY = new THREE.Quaternion();\n        var quaternionZ = new THREE.Quaternion();\n        var quaternionE = new THREE.Quaternion();\n\n        var oldPosition = new THREE.Vector3();\n        var oldScale = new THREE.Vector3();\n        var oldRotationMatrix = new THREE.Matrix4();\n\n        var parentRotationMatrix  = new THREE.Matrix4();\n        var parentScale = new THREE.Vector3();\n\n        var worldPosition = new THREE.Vector3();\n        var worldRotation = new THREE.Euler();\n        var worldRotationMatrix  = new THREE.Matrix4();\n        var camPosition = new THREE.Vector3();\n        var camRotation = new THREE.Euler();\n\n        this.attach = function ( object ) {\n\n            scope.object = object;\n\n            this.gizmo[_mode].show();\n\n            scope.update();\n\n            scope.updateUnitVectors();\n\n        };\n\n        this.detach = function ( object ) {\n\n            scope.object = undefined;\n            this.axis = null;\n\n            this.gizmo[_mode].hide();\n\n        };\n\n        this.setMode = function ( mode ) {\n\n            _mode = mode ? mode : _mode;\n\n            if ( _mode == \"scale\" ) scope.space = \"local\";\n\n            this.gizmo[_mode].show();\n\n            this.update();\n            scope.dispatchEvent( changeEvent );\n\n        };\n\n        this.getPicker = function () {\n\n            return scope.gizmo[_mode].hemiPicker.children;\n\n        };\n\n        this.setPosition = function ( position ) {\n\n            this.object.position.copy ( position );\n            this.update();\n        \n        };\n\n        this.setNormal = function ( normal ) {\n\n            tempQuaternion.setFromUnitVectors( this.normal, normal );\n            this.unitX.applyQuaternion( tempQuaternion );\n            this.unitY.applyQuaternion( tempQuaternion );\n            this.unitZ.applyQuaternion( tempQuaternion );\n            this.normal.copy( normal );\n            if (this.object) {\n                this.object.quaternion.multiply ( tempQuaternion );\n            }\n            this.update();\n        };\n\n        this.setRotation = function (rotationMatrix) {\n            if (this.object) {\n                this.object.quaternion.setFromRotationMatrix(rotationMatrix);\n                this.update();\n                this.updateUnitVectors();\n            }\n        };\n\n        this.setSnap = function ( snap, delta ) {\n\n            scope.snap = snap;\n            scope.snapDelta = delta;\n\n        };\n\n        this.setSize = function ( size ) {\n\n            scope.size = size;\n            this.update();\n            scope.dispatchEvent( changeEvent );\n\n        };\n\n        this.setSpace = function ( space ) {\n\n            scope.space = space;\n            this.update();\n            scope.dispatchEvent( changeEvent );\n\n        };\n\n        this.update = function (highlight) {\n\n            if ( scope.object === undefined ) return;\n\n            scope.object.updateMatrixWorld();\n            worldPosition.setFromMatrixPosition( scope.object.matrixWorld );\n            worldRotation.setFromRotationMatrix( tempMatrix.extractRotation( scope.object.matrixWorld ) );\n\n            camera.updateMatrixWorld();\n            camPosition.setFromMatrixPosition( camera.matrixWorld );\n            //camRotation.setFromRotationMatrix( tempMatrix.extractRotation( camera.matrixWorld ) );\n\n            this.position.copy( worldPosition );\n\n            this.quaternion.setFromEuler( worldRotation );\n\n            this.normal.set( 0, 0, 1 );\n            this.normal.applyEuler( worldRotation );\n\n            // keep same screen height (100px)\n            var height;\n            if ( camera.isPerspective ) {\n                var dist = worldPosition.distanceTo( camPosition );\n                height = 2 * Math.tan( camera.fov * Math.PI / 360 ) * dist;\n            } else {\n                // orthographic, so the world height is simply top minus bottom\n                height = camera.top - camera.bottom;\n            }\n            var rect = domElement.getBoundingClientRect();\n            // multiply 100 pixels by world height for the window, divide by window height in pixels,\n            // to get world height equivalent to 100 pixels.\n            scale = this.clientScale * 100 * height / rect.height;\n            this.scale.set( scale, scale, scale );\n\n            // Set the gizmo position with the specified offset.\n            if(this.gizmoOffset) {\n                this.position.add(this.gizmoOffset);\n            }\n            this.updateMatrixWorld();\n            //eye.copy( camPosition ).sub( worldPosition ).normalize();\n\n            //if ( scope.space == \"local\" )\n            //    this.gizmo[_mode].update( worldRotation, eye );\n            //else if ( scope.space == \"world\" )\n            //    this.gizmo[_mode].update( new THREE.Euler(), eye );\n\n            if (highlight)\n                this.gizmo[_mode].highlight( scope.axis );\n\n        };\n\n        this.setGizmoOffset = function(vec) {\n            // Reset the gizmo if no vector passed in.\n            this.gizmoOffset = !vec ? new THREE.Vector3(0,0,0) : vec;\n            this.update();\n        }\n\n        this.updateUnitVectors = function () {\n\n            this.unitX.set( 1, 0, 0 );\n            this.unitY.set( 0, 1, 0 );\n            this.unitZ.set( 0, 0, 1 );\n            this.unitX.applyEuler( worldRotation );\n            this.unitY.applyEuler( worldRotation );\n            this.unitZ.applyEuler( worldRotation );\n\n        };\n\n        this.showRotationGizmos = function (set) {\n\n            var handles = this.gizmo[_mode].handles.children;\n            for ( var i = 0; i < handles.length; i++ ) {\n                var child = handles[i];\n                child.visible = true;\n                if ( child.name.search(\"R\") !== -1 ) child.visible = set;\n            }\n            this.useAllPickers = set;\n            \n        };\n\n        this.highlight = function () {\n\n            this.gizmo[_mode].highlight( this.axis || \"Z\" );\n\n        };\n\n        this.onPointerHover = function( event ) {\n\n            if ( scope.object === undefined || _dragging === true ) return false;\n\n            var pointer = event;\n\n            var intersect = intersectObjects( pointer, scope.useAllPickers? scope.gizmo[_mode].pickers.children: scope.gizmo[_mode].subPickers.children );\n\n            var axis = null;\n            var mode = \"\";\n\n            if ( intersect ) {\n\n                axis = intersect.object.name;\n                mode = axis.search(\"R\") != -1 ? \"rotate\" : \"translate\";\n\n            }\n\n            if ( scope.axis !== axis ) {\n\n                scope.axis = axis;\n                scope.gizmo[_mode].activeMode = mode;\n                scope.update(true);\n                scope.dispatchEvent( changeEvent );\n\n            } \n\n            if (scope.axis === null) {\n\n                scope.gizmo[_mode].show();\n            \n            }\n\n            return intersect? true : false;\n\n        };\n\n        this.isDragging = function() {\n            return _dragging;\n        };\n\n        this.onPointerDown = function( event ) {\n\n            if ( scope.object === undefined || _dragging === true ) return false;\n            \n            var pointer = event;\n\n            if ( event.pointerType === 'touch' ) {\n\n                var intersect = intersectObjects( pointer, scope.useAllPickers? scope.gizmo[_mode].pickers.children: scope.gizmo[_mode].subPickers.children );\n\n                var axis = null;\n                var mode = \"\";\n\n                if ( intersect ) {\n\n                    axis = intersect.object.name;\n                    mode = axis.search(\"R\") != -1 ? \"rotate\" : \"translate\";\n\n                }\n\n                if ( scope.axis !== axis ) {\n\n                    scope.axis = axis;\n                    scope.gizmo[_mode].activeMode = mode;\n                }\n            }\n\n            var intersect = null;\n\n            if ( pointer.button === 0 || pointer.button === -1 || pointer.button === undefined ) {\n\n                intersect = intersectObjects( pointer, scope.useAllPickers? scope.gizmo[_mode].pickers.children: scope.gizmo[_mode].subPickers.children );\n\n                if ( intersect ) {\n\n                    scope.dispatchEvent( mouseDownEvent );\n\n                    scope.axis = intersect.object.name;\n\n                    scope.update();\n\n                    eye.copy( camera.position ).sub( worldPosition ).normalize();\n\n                    scope.gizmo[_mode].setActivePlane( scope.axis, eye, scope.space === \"local\" );\n\n                    var planeIntersect = intersectObjects( pointer, [scope.gizmo[_mode].activePlane] );\n\n                    if ( planeIntersect )\n                        offset.copy( planeIntersect.point );\n\n                    oldPosition.copy( scope.object.position );\n                    oldScale.copy( scope.object.scale );\n\n                    oldRotationMatrix.extractRotation( scope.object.matrix );\n                    worldRotationMatrix.extractRotation( scope.object.matrixWorld );\n\n                    if ( scope.object.parent ) {\n                        parentRotationMatrix.extractRotation( scope.object.parent.matrixWorld );\n                        parentScale.setFromMatrixScale( tempMatrix.getInverse( scope.object.parent.matrixWorld ) );\n                    } else {\n                        parentRotationMatrix.extractRotation( scope.object.matrixWorld );\n                        parentScale.setFromMatrixScale( tempMatrix.getInverse( scope.object.matrixWorld ) );\n                    }\n\n                    // show rotation start line and ticks\n                    if ( _mode === \"transrotate\" && scope.gizmo[_mode].activeMode === \"rotate\" ) {\n                        scope.startLine.geometry.vertices[0].set(0, 0, 0).applyMatrix4( scope.matrixWorld );\n                        scope.startLine.geometry.vertices[1].set(0, 0, 1).applyMatrix4( scope.matrixWorld );\n                        scope.startLine.geometry.verticesNeedUpdate = true;\n                        scope.parent.add( scope.startLine );\n\n                        var pos = scope.object.geometry.getAttribute('position');\n                        var pt1 = new THREE.Vector3().fromAttribute(pos, 0).applyMatrix4( scope.object.matrixWorld );\n                        var pt2 = new THREE.Vector3().fromAttribute(pos, 1).applyMatrix4( scope.object.matrixWorld );\n                        var pt3 = new THREE.Vector3().fromAttribute(pos, 2).applyMatrix4( scope.object.matrixWorld );\n                        var pt4 = new THREE.Vector3().fromAttribute(pos, 3).applyMatrix4( scope.object.matrixWorld );\n                        if (scope.axis === \"RX\") {\n                            pt1.lerp(pt3, 0.5);\n                            pt2.lerp(pt4, 0.5);\n                            var dist = pt1.distanceTo(pt2);\n                            scope.centerLine.material.dashSize = dist / 15;\n                            scope.centerLine.material.gapSize = dist / 30;\n                            scope.centerLine.geometry.vertices[0].copy(pt1);\n                            scope.centerLine.geometry.vertices[1].copy(pt2);\n                        } else {\n                            pt1.lerp(pt2, 0.5);\n                            pt3.lerp(pt4, 0.5);\n                            var dist = pt1.distanceTo(pt3);\n                            scope.centerLine.material.dashSize = dist / 15;\n                            scope.centerLine.material.gapSize = dist / 30;\n                            scope.centerLine.geometry.vertices[0].copy(pt1);\n                            scope.centerLine.geometry.vertices[1].copy(pt3);\n                        }\n                        scope.centerLine.geometry.computeLineDistances();\n                        scope.centerLine.geometry.verticesNeedUpdate = true;\n                        scope.parent.add( scope.centerLine );\n\n                        scope.ticks[scope.axis].position.copy( scope.position );\n                        scope.ticks[scope.axis].quaternion.copy( scope.quaternion );\n                        scope.ticks[scope.axis].scale.copy( scope.scale );\n                        scope.parent.add( scope.ticks[scope.axis] );\n                    }\n\n                }\n\n            }\n\n            _dragging = true;\n\n            return intersect? true: false;\n\n        }\n\n        this.onPointerMove = function( event ) {\n\n            if ( scope.object === undefined || scope.axis === null || _dragging === false ) return false;\n\n            var pointer = event;\n\n            var planeIntersect = intersectObjects( pointer, [scope.gizmo[_mode].activePlane] );\n\n            if ( planeIntersect )\n                point.copy( planeIntersect.point );\n\n            var mode = scope.gizmo[_mode].activeMode;\n            if ( mode == \"translate\" ) {\n\n                point.sub( offset );\n                point.multiply(parentScale);\n\n                if ( scope.space == \"local\" ) {\n\n                    point.applyMatrix4( tempMatrix.getInverse( worldRotationMatrix ) );\n\n                    if ( scope.axis.search(\"X\") == -1 ) point.x = 0;\n                    if ( scope.axis.search(\"Y\") == -1 ) point.y = 0;\n                    if ( scope.axis.search(\"Z\") == -1 ) point.z = 0;\n\n                    point.applyMatrix4( oldRotationMatrix );\n\n                    scope.object.position.copy( oldPosition );\n                    scope.object.position.add( point );\n\n                }\n\n                if ( scope.space == \"world\" || scope.axis.search(\"XYZ\") != -1 ) {\n\n                    projX.copy( this.unitX );\n                    projY.copy( this.unitY );\n                    projZ.copy( this.unitZ );\n                    tempVector.set( 0, 0, 0 );\n                    if ( scope.axis.search(\"X\") != -1 ) {\n                        projX.multiplyScalar( point.dot( this.unitX ) );\n                        tempVector.add( projX );\n                    }\n                    if ( scope.axis.search(\"Y\") != -1 ) {\n                        projY.multiplyScalar( point.dot( this.unitY ) );\n                        tempVector.add(projY);\n                    }\n                    if ( scope.axis.search(\"Z\") != -1 ) {\n                        projZ.multiplyScalar( point.dot( this.unitZ ) );\n                        tempVector.add( projZ );\n                    }\n                    point.copy( tempVector );\n\n                    point.applyMatrix4( tempMatrix.getInverse( parentRotationMatrix ) );\n\n                    scope.object.position.copy( oldPosition );\n                    scope.object.position.add( point );\n\n                }\n\n            } else if ( mode == \"scale\" ) {\n\n                point.sub( offset );\n                point.multiply(parentScale);\n\n                if ( scope.space == \"local\" ) {\n\n                    if ( scope.axis == \"XYZ\") {\n\n                        scale = 1 + ( ( point.y ) / 50 );\n\n                        scope.object.scale.x = oldScale.x * scale;\n                        scope.object.scale.y = oldScale.y * scale;\n                        scope.object.scale.z = oldScale.z * scale;\n\n                    } else {\n\n                        point.applyMatrix4( tempMatrix.getInverse( worldRotationMatrix ) );\n\n                        if ( scope.axis == \"X\" ) scope.object.scale.x = oldScale.x * ( 1 + point.x / 50 );\n                        if ( scope.axis == \"Y\" ) scope.object.scale.y = oldScale.y * ( 1 + point.y / 50 );\n                        if ( scope.axis == \"Z\" ) scope.object.scale.z = oldScale.z * ( 1 + point.z / 50 );\n\n                    }\n\n                }\n\n            } else if ( mode == \"rotate\") {\n\n                point.sub( worldPosition );\n                point.multiply(parentScale);\n                tempVector.copy(offset).sub( worldPosition );\n                tempVector.multiply(parentScale);\n\n                if ( scope.axis == \"RE\" ) {\n\n                    point.applyMatrix4( tempMatrix.getInverse( lookAtMatrix ) );\n                    tempVector.applyMatrix4( tempMatrix.getInverse( lookAtMatrix ) );\n\n                    rotation.set( Math.atan2( point.z, point.y ), Math.atan2( point.x, point.z ), Math.atan2( point.y, point.x ) );\n                    offsetRotation.set( Math.atan2( tempVector.z, tempVector.y ), Math.atan2( tempVector.x, tempVector.z ), Math.atan2( tempVector.y, tempVector.x ) );\n\n                    tempQuaternion.setFromRotationMatrix( tempMatrix.getInverse( parentRotationMatrix ) );\n\n                    var rotz = rotation.z - offsetRotation.z;\n                    if ( scope.snap !== null ) {\n                        var rotsnap = Math.round( rotz / scope.snap ) * scope.snap;\n                        if ( Math.abs(rotsnap-rotz) < scope.snapDelta ) {\n                            rotz = rotsnap;\n                        }\n                    }\n                    quaternionE.setFromAxisAngle( eye, rotz );\n                    quaternionXYZ.setFromRotationMatrix( worldRotationMatrix );\n\n                    tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionE );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionXYZ );\n\n                    scope.object.quaternion.copy( tempQuaternion );\n\n                } else if ( scope.axis == \"RXYZE\" ) {\n\n                    var tempAxis = point.clone().cross(tempVector).normalize(); // rotation axis\n\n                    tempQuaternion.setFromRotationMatrix( tempMatrix.getInverse( parentRotationMatrix ) );\n\n                    var rot = - point.clone().angleTo(tempVector);\n                    if ( scope.snap !== null ) {\n                        var rotsnap = Math.round( rot / scope.snap ) * scope.snap;\n                        if ( Math.abs(rotsnap-rot) < scope.snapDelta ) {\n                            rot = rotsnap;\n                        }\n                    }\n                    quaternionX.setFromAxisAngle( tempAxis, rot );\n                    quaternionXYZ.setFromRotationMatrix( worldRotationMatrix );\n\n                    tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionX );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionXYZ );\n\n                    scope.object.quaternion.copy( tempQuaternion );\n\n                } else if ( scope.space == \"local\" ) {\n\n                    point.applyMatrix4( tempMatrix.getInverse( worldRotationMatrix ) );\n\n                    tempVector.applyMatrix4( tempMatrix.getInverse( worldRotationMatrix ) );\n\n                    var projx = point.dot(this.unitX), projy = point.dot(this.unitY), projz = point.dot(this.unitZ);\n                    var tempx = tempVector.dot(this.unitX), tempy = tempVector.dot(this.unitY), tempz = tempVector.dot(this.unitZ);\n                    rotation.set( Math.atan2( projz, projy ), Math.atan2( projx, projz ), Math.atan2( projy, projx ) );\n                    offsetRotation.set( Math.atan2( tempz, tempy ), Math.atan2( tempx, tempz ), Math.atan2( tempy, tempx ) );\n\n                    var rotx = rotation.x - offsetRotation.x;\n                    var roty = rotation.y - offsetRotation.y;\n                    var rotz = rotation.z - offsetRotation.z;\n                    if ( scope.snap !== null ) {\n                        if ( scope.axis.search(\"X\") != -1 ) {\n                            var rotsnap = Math.round( rotx / scope.snap ) * scope.snap;\n                            if ( Math.abs(rotsnap-rotx) < scope.snapDelta ) {\n                                rotx = rotsnap;\n                            }\n                        }\n                        if ( scope.axis.search(\"Y\") != -1 ) {\n                            var rotsnap = Math.round( roty / scope.snap ) * scope.snap;\n                            if ( Math.abs(rotsnap-roty) < scope.snapDelta ) {\n                                roty = rotsnap;\n                            }\n                        }\n                        if ( scope.axis.search(\"Z\") != -1 ) {\n                            var rotsnap = Math.round( rotz / scope.snap ) * scope.snap;\n                            if ( Math.abs(rotsnap-rotz) < scope.snapDelta ) {\n                                rotz = rotsnap;\n                            }\n                        }\n                    }\n                    quaternionX.setFromAxisAngle( this.unitX, rotx );\n                    quaternionY.setFromAxisAngle( this.unitY, roty );\n                    quaternionZ.setFromAxisAngle( this.unitZ, rotz );\n                    quaternionXYZ.setFromRotationMatrix( oldRotationMatrix );\n\n                    if ( scope.axis == \"RX\" ) quaternionXYZ.multiplyQuaternions( quaternionXYZ, quaternionX );\n                    if ( scope.axis == \"RY\" ) quaternionXYZ.multiplyQuaternions( quaternionXYZ, quaternionY );\n                    if ( scope.axis == \"RZ\" ) quaternionXYZ.multiplyQuaternions( quaternionXYZ, quaternionZ );\n\n                    scope.object.quaternion.copy( quaternionXYZ );\n\n                } else if ( scope.space == \"world\" ) {\n\n                    var projx = point.dot(this.unitX), projy = point.dot(this.unitY), projz = point.dot(this.unitZ);\n                    var tempx = tempVector.dot(this.unitX), tempy = tempVector.dot(this.unitY), tempz = tempVector.dot(this.unitZ);\n                    rotation.set( Math.atan2( projz, projy ), Math.atan2( projx, projz ), Math.atan2( projy, projx ) );\n                    offsetRotation.set( Math.atan2( tempz, tempy ), Math.atan2( tempx, tempz ), Math.atan2( tempy, tempx ) );\n\n                    tempQuaternion.setFromRotationMatrix( tempMatrix.getInverse( parentRotationMatrix ) );\n\n                    var rotx = rotation.x - offsetRotation.x;\n                    var roty = rotation.y - offsetRotation.y;\n                    var rotz = rotation.z - offsetRotation.z;\n                    if ( scope.snap !== null ) {\n                        if ( scope.axis.search(\"X\") != -1 ) {\n                            var rotsnap = Math.round( rotx / scope.snap ) * scope.snap;\n                            if ( Math.abs(rotsnap-rotx) < scope.snapDelta ) {\n                                rotx = rotsnap;\n                            }\n                        }\n                        if ( scope.axis.search(\"Y\") != -1 ) {\n                            var rotsnap = Math.round( roty / scope.snap ) * scope.snap;\n                            if ( Math.abs(rotsnap-roty) < scope.snapDelta ) {\n                                roty = rotsnap;\n                            }\n                        }\n                        if ( scope.axis.search(\"Z\") != -1 ) {\n                            var rotsnap = Math.round( rotz / scope.snap ) * scope.snap;\n                            if ( Math.abs(rotsnap-rotz) < scope.snapDelta ) {\n                                rotz = rotsnap;\n                            }\n                        }\n                    }\n                    quaternionX.setFromAxisAngle( this.unitX, rotx );\n                    quaternionY.setFromAxisAngle( this.unitY, roty );\n                    quaternionZ.setFromAxisAngle( this.unitZ, rotz );\n                    quaternionXYZ.setFromRotationMatrix( worldRotationMatrix );\n\n                    if ( scope.axis == \"RX\" ) tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionX );\n                    if ( scope.axis == \"RY\" ) tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionY );\n                    if ( scope.axis == \"RZ\" ) tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionZ );\n\n                    tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionXYZ );\n\n                    scope.object.quaternion.copy( tempQuaternion );\n\n                }\n\n                // show rotation end line\n                if (_mode === \"transrotate\" ) {\n                    scope.add( scope.endLine );\n                    scope.add( scope.centerMark );\n                }\n\n            }\n\n            // update matrix\n            scope.object.matrixAutoUpdate = true;\n\n            scope.update(true);\n            scope.dispatchEvent( changeEvent );\n            scope.dispatchEvent( objectChangeEvent );\n\n            return planeIntersect? true : false;\n\n        }\n\n        this.onPointerUp = function( event ) {\n\n            if ( _dragging && ( scope.axis !== null ) ) {\n                mouseUpEvent.mode = _mode;\n                scope.dispatchEvent( mouseUpEvent )\n            }\n            _dragging = false;\n\n            this.gizmo[_mode].show();\n\n            this.updateUnitVectors();\n\n            // remove rotation start/end lines\n            if ( _mode === \"transrotate\" && this.gizmo[_mode].activeMode === \"rotate\" ) {\n                this.remove( this.endLine );\n                this.remove( this.centerMark );\n                this.parent.remove( this.centerLine );\n                this.parent.remove( this.startLine );\n                this.parent.remove( this.ticks[this.axis] );\n            }\n\n            return false;\n\n        }\n\n        function intersectObjects( pointer, objects ) {\n            return THREE.TransformControls.intersectObjects(pointer.canvasX, pointer.canvasY, objects, camera, true);\n        }\n    };\n\n    THREE.TransformControls.intersectObjects = (function () {\n\n        var pointerVector = new THREE.Vector3();\n        var pointerDir = new THREE.Vector3();\n        var ray = new THREE.Raycaster();\n\n        return function(clientX, clientY, objects, camera, recursive) {\n\n            // Convert client to viewport coords (in [-1,1]^2)\n            var x =  (clientX  / camera.clientWidth)  * 2 - 1;\n            var y = -(clientY  / camera.clientHeight) * 2 + 1; // y-direction flips between canvas and viewport coords\n\n            if (camera.isPerspective) {\n                pointerVector.set(x, y, 0.5);\n                pointerVector.unproject(camera);\n                ray.set(camera.position, pointerVector.sub(camera.position).normalize());\n            } else {\n                pointerVector.set(x, y, -1);\n                pointerVector.unproject(camera);\n                pointerDir.set(0, 0, -1);\n                ray.set(pointerVector, pointerDir.transformDirection(camera.matrixWorld));\n            }\n\n            var intersections = ray.intersectObjects(objects, recursive);\n            return intersections[0] ? intersections[0] : null;\n        };\n    })();\n\n    THREE.TransformControls.prototype = Object.create( THREE.Object3D.prototype );\n\n};\n","\nimport { init_TransformGizmos } from '../../thirdparty/three.js/TransformControls';\nconst debounce = require(\"lodash/debounce\");\n\n// Declared at the bottom, inside a function.\nvar SectionMeshClass = null;\nvar avp = Autodesk.Viewing.Private;\n\n/**\n * Tool that provides visual controls for the user to change the cutplane's position and angle.\n * It can (and should) be hooked to [ToolController's registerTool]{@Autodesk.Viewing.ToolController#registerTool}\n *\n * @param {Autodesk.Viewing.Viewer3D} viewer - Viewer3D instance\n * @param {Object} config - Configuration values\n * @param {Object} options.tintColor - Object containing attributes r, g, b in the range [0..1]\n * @param {Number} options.tintIntensity - Value range [0..1]\n * @constructor\n */\nexport var SectionTool = function(viewer, options)\n{\n    var _viewer  = viewer.impl;\n\n    var _names = [\"section\"];\n    var _active = false;\n\n    var _isDragging = false;\n    var _boxChanged = false;\n    var _isPlaneOn = true;\n    var _tintColor = options.tintColor;\n    var _tintIntensity = options.tintIntensity;\n\n    var _transRotControl;\n    var _transControl;\n    var _gizmoOffsetRight = isNaN(options.gizmoOffsetRight) ? 200 : options.gizmoOffsetRight; // 200 So the gizmo won't be covered by the View Cube.\n    var _gizmoOffsetLeft = isNaN(options.gizmoOffsetLeft) ? 80 : options.gizmoOffsetLeft;  \n    var _gizmoOffsetTop = isNaN(options.gizmoOffsetTop) ? 80 : options.gizmoOffsetTop;\n    var _gizmoOffsetBottom = isNaN(options.gizmoOffsetBottom) ? 80 : options.gizmoOffsetBottom;\n    var _gizmoNewClientPos = new THREE.Vector3();\n    var _controlOffset = new THREE.Vector3();\n    var _controlNewPosition = new THREE.Vector3();\n\n    var _trcOffset;\n    var _sectionGroups = [];\n    var _sectionPlanes = [];\n    var _sectionPicker = [];\n    var _activeMode = \"\";\n    var _overlayName = \"gizmo\";\n    var _touchType = null;\n    var _initialized = false;\n    var _visibleAtFirst = true;\n    var _outlineIndices = [[0, 1], [1, 3], [3, 2], [2, 0]];\n    var _priority = 70;\n    var _selectionOpacity = 0.25;\n    var _selectionColor = 0x287EEA;\n\n    var _displaySectionHatches = true;\n\n    const sendAnalyticsDebounced = debounce((from, type, action) => {\n        avp.analytics.track('viewer.section', {\n            from: from,\n            type: type,\n            action: action,\n        });\n    }, 2000);\n\n    init_TransformGizmos();\n    init_SectionMesh();\n\n    function initControl() {\n\n        if (_initialized) {\n            // Verify overlays are added.\n            _viewer.addOverlay(_overlayName, _transRotControl);\n            _viewer.addOverlay(_overlayName, _transControl);\n            return;\n        }\n\n        _transRotControl = new THREE.TransformControls(_viewer.camera, _viewer.canvas, \"transrotate\");\n        _transRotControl.addEventListener('change', updateViewer);\n        _transRotControl.setSnap(Math.PI/2, Math.PI/36); // snap to 90 degs within 5 degs range\n        \n        _transControl = new THREE.TransformControls(_viewer.camera, _viewer.canvas, \"translate\");\n        _transControl.addEventListener('change', updateViewer);\n        _transControl.addEventListener('change', adjustGizmoToBounds);\n\n        // add to overlay scene\n        if (_viewer.overlayScenes[_overlayName] === undefined) {\n            _viewer.createOverlayScene(_overlayName);\n        }\n        _viewer.addOverlay(_overlayName, _transRotControl);\n        _viewer.addOverlay(_overlayName, _transControl);\n\n        viewer.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, updateControls);\n        viewer.addEventListener(Autodesk.Viewing.ISOLATE_EVENT, updateSections);\n        viewer.addEventListener(Autodesk.Viewing.HIDE_EVENT, updateSections);\n        viewer.addEventListener(Autodesk.Viewing.SHOW_EVENT, updateSections);\n        viewer.addEventListener(Autodesk.Viewing.MODEL_TRANSFORM_CHANGED_EVENT, updateSections);\n        \n        _initialized = true;\n    }\n\n    function deinitControl() {\n        \n        if (!_initialized)\n            return;\n    \n        _viewer.removeOverlay(_overlayName, _transRotControl);\n        _transRotControl.removeEventListener('change', updateViewer);\n        _transRotControl = null;\n        _viewer.removeOverlay(_overlayName, _transControl);\n        _transControl.removeEventListener('change', updateViewer);\n        _transControl.removeEventListener('change', adjustGizmoToBounds);\n        _transControl = null;\n        _viewer.removeOverlayScene(_overlayName);\n\n        viewer.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT, updateControls);\n        viewer.removeEventListener(Autodesk.Viewing.ISOLATE_EVENT, updateSections);\n        viewer.removeEventListener(Autodesk.Viewing.HIDE_EVENT, updateSections);\n        viewer.removeEventListener(Autodesk.Viewing.SHOW_EVENT, updateSections);\n        viewer.removeEventListener(Autodesk.Viewing.MODEL_TRANSFORM_CHANGED_EVENT, updateSections);\n        \n        _initialized = false;\n    }\n\n    function updateViewer() {\n        _viewer.invalidate(false, false, true);\n    }\n\n    function updateControls() {\n\n        adjustGizmoToBounds();\n\n        if (_transRotControl) {\n            _transRotControl.update();\n        }\n        if (_transControl) {\n            _transControl.update();\n        }\n    }\n\n    function adjustGizmoToBounds() {\n\n        if (!_transRotControl || !_transRotControl.object) {\n            return;\n        }\n        \n        const client = _viewer.worldToClient(_transRotControl.position);\n        const rect = _viewer.getCanvasBoundingClientRect();\n        _gizmoNewClientPos.copy(client);\n      \n        if (client.x < _gizmoOffsetLeft) {\n            _gizmoNewClientPos.x = _gizmoOffsetLeft;\n        } else if (client.x > rect.width - _gizmoOffsetRight) {\n            _gizmoNewClientPos.x = rect.width - _gizmoOffsetRight;\n        }\n\n        if (client.y < _gizmoOffsetTop) {\n            _gizmoNewClientPos.y = _gizmoOffsetTop;\n        } else if (client.y > rect.height - _gizmoOffsetBottom) {\n            _gizmoNewClientPos.y = rect.height - _gizmoOffsetBottom;\n        }\n\n        if (_gizmoNewClientPos.x !== client.x || _gizmoNewClientPos.y !== client.y) {\n            const intersection = THREE.TransformControls.intersectObjects(_gizmoNewClientPos.x, _gizmoNewClientPos.y, [_transRotControl.object], _viewer.camera, false);\n            if (intersection) {\n                // In section planes the group position is (0,0,0) and has no impact.\n                // In section box the group position is the translation of the box, and is needed for\n                // positioning the gizmo in the right place.\n                const groupPosition = _sectionGroups[0].position;\n                _controlOffset.copy(_transRotControl.object.position).add(groupPosition);\n                _controlNewPosition.copy(intersection.point).sub(_controlOffset);\n                _transRotControl.setGizmoOffset(_controlNewPosition);\n            }\n        }\n    }\n\n    function updateSections() {\n        if (_active && _sectionPlanes.length === 1) {\n            updatePlaneMeshes(true);\n            updateControls();\n            updateCapMeshes(new THREE.Plane().setComponents(_sectionPlanes[0].x, _sectionPlanes[0].y, _sectionPlanes[0].z, _sectionPlanes[0].w));\n        }\n    }\n\n    /*function mix(a, b, val) {\n        return a * (1.0 - val) + b * val;\n    }*/\n    \n    function getDiffuseColor(material) {\n       return (material && material.color) || new THREE.Color(0xffffff);\n    }\n\n    /*function getSpecularColor(material) {\n        return (material && material.specular) || new THREE.Color(0xffffff);\n    }\n\n    function tintColor(c) {\n        var intensity = Autodesk.Viewing.Extensions.Section.tintIntensity;\n        var tc = _tintColor;\n        c.r = mix(c.r, tc.r, intensity);\n        c.g = mix(c.g, tc.g, intensity);\n        c.b = mix(c.b, tc.b, intensity);\n    }*/\n    \n    // Object used to iterator all fragments in all dbids in all models in a scene\n    // _timeSlice is the time in milliseconds before the iterator will allow itself\n    // to be interrupted. _sliceDelay is the time in milliseconds the iterator delays\n    // before starting a new time slice. The default values are 15 and 0 respectively.\n    // I did some experiments and it seemed like these values worked pretty well.\n    // _sliceDelay doesn't seem to matter very much, but making _timeSlice much\n    // larger will cause highlights to look jerky.\n    function FragmentIterator(_timeSlice, _sliceDelay) {\n\n        var _capTimer = 0;      // Timer used to delay time slices\n        var _callback;          // Callback for each fragment\n        var _models;            // Array of models in the scene\n        var _curModel;          // Current model\n        var _dbIds = [];        // Database ids for the current model\n        var _fragIds = [];      // Fragment ids for the current database id\n        var _instanceTree;       // Instance tree for current model\n        var _m;                 // Current index in _models\n        var _d;                 // Current index in _dbIds\n        var _f;                 // Current index in _fragIds\n\n        // Default value for _timeSlize and _sliceDelay\n        _timeSlice = _timeSlice || 15;\n        _sliceDelay = _sliceDelay || 0;\n\n        // Start the iterator\n        // models is the array of models to iterate\n        // delay is a delay to start the iteration. < 0 starts without any delay\n        // callback is the callback for each fragment:\n        //   callback(fragId, dbId, model, lastFrag)\n        // lastFrag is a boolean that is true when fragId is the last fragment for dbId.\n        this.start = function(models, delay, callback) {\n            reset(models);\n\n            _callback = callback;\n            if (callback) {\n                if (delay >= 0)\n                    _capTimer = setTimeout(doIteration, delay);\n                else\n                    doIteration();\n            }\n        };\n\n        // Reset the iterator, this is so we can clear the manager at the end.\n        function reset(models) {\n            if (_capTimer)\n                clearTimeout(_capTimer);\n            _capTimer = 0;\n            _models = models;\n            _dbIds.length = 0;\n            _fragIds.length = 0;\n            _instanceTree = null;\n            _m = -1;\n            _d = 0;\n            _f = 0;\n        }\n\n        // Do a single time slice\n        function doIteration() {\n            _capTimer = 0;\n            var endTime = performance.now() + _timeSlice;\n            while (performance.now() < endTime) {\n                // If we are done, then return\n                if (!next()) {\n                    // The cap scene is in sceneAfter, so we need to redraw the model to see the caps.\n                    // LMV-2571 - clear the render, as otherwise we will draw transparent objects atop themselves.\n                    _viewer.invalidate(true, true);\n                    // Clear everything when we are done\n                    reset(null);\n                    return;\n                }\n\n                // Call the call back function\n                _callback(_fragIds[_f], _dbIds[_d], _curModel, _f + 1 >= _fragIds.length, !_models || _m >= _models.length);\n            }\n\n            // Schedule the next time slice\n            _capTimer = setTimeout(doIteration, _sliceDelay);\n        }\n\n        // Advance to the next model in _models\n        function nextModel() {\n            // Continue processing the next model in _models\n            if (_models && _m < _models.length) {\n                // Go to next model\n                while (++_m < _models.length) {\n                    _instanceTree = _models[_m].getInstanceTree();\n                    // Only process the model, if it has a fragment map\n                    if (_instanceTree) {\n                        // Get the list of dbIds.\n                        _dbIds.length = 0;\n                        _instanceTree.enumNodeChildren(_models[_m].getRootId(), function(dbId) {\n                            _dbIds.push(dbId);\n                        }, true);\n                        // Only process the model if we got some ids\n                        if (_dbIds.length > 0) {\n                            // Set the current model and newly loaded dbIds\n                            _curModel = _models[_m];\n                            return _curModel;\n                        }\n                    }\n                }\n            }\n\n            // Done clear the current model and new loaded dbIds\n            _curModel = null;\n\n            // End of the models\n            return false;\n        }\n\n        // Advance to the next database id\n        function nextDbId() {\n            // At the end, return false\n            if (_d >= _dbIds.length)\n                return false;\n\n            // Go to next database id\n            while (++_d < _dbIds.length) {\n                var dbId = _dbIds[_d];\n                // Only process dbIds that are not hidden and not off\n                if (!_instanceTree.isNodeHidden(dbId) && !_instanceTree.isNodeOff(dbId)) {\n                    //All fragments that belong to the same node make part of the\n                    //same object so we have to accumulate all their intersections into one list\n                    _fragIds.length = 0;\n                    _instanceTree.enumNodeFragments(dbId, function(fragId) {\n                        _fragIds.push(fragId);\n                    }, false);\n                    // Only process the database id if there are some fragments\n                    if (_fragIds.length > 0)\n                        return true;\n                }\n            }\n\n            // end of the database ids\n            return false;\n        }\n\n        // Advance to the next fragment\n        function next() {\n            // If we are not a the end of the fragment list, then process it\n            if (++_f < _fragIds.length)\n                return true;\n\n            // Start the fragment list at the beginning\n            _f = 0;\n            for ( ; ; ) {\n                // If we have more database ids, then process them\n                if (nextDbId())\n                    return true;\n                // If we don't have another model, then we are done\n                if (!nextModel())\n                    return false;\n                // restart the database ids for the new model\n                _d = -1;\n            }\n        }\n    }\n\n    // Use the same fragment iterator for all fragments\n    var _fragIterator = new FragmentIterator();\n\n    function updateCapMeshes(plane) {\n        if (!_displaySectionHatches) {\n            // LMV-5781: Do not render the section hatches if the preference is turned on. \n            return;\n        }\n        const cg = Autodesk.Viewing.Extensions.CompGeom;\n\n        //When drawing a 2D material in 3D space we will want to skip binding the G-buffer\n        //when rendering the scene that contains that material\n        _viewer.sceneAfter.skipDepthTarget = true;\n\n        _removeSections();\n\n        var section3D = new THREE.Object3D();\n        section3D.name = \"section3D\";\n        _viewer.scene.add(section3D);\n        \n        var section2D = new THREE.Object3D();\n        section2D.name = \"section2D\";\n        _viewer.sceneAfter.add(section2D);\n        \n        var toPlaneCoords = cg.makePlaneBasis(plane);\n        var fromPaneCoords = new THREE.Matrix4().getInverse(toPlaneCoords);\n\n        var mat2dname = _viewer.matman().create2DMaterial(null, {skipCircles:true, skipEllipticals:true, isScreenSpace: true}, false, false);\n        var mat2d = _viewer.matman().findMaterial(null, mat2dname);\n        mat2d.transparent = true;\n        mat2d.depthTest = true;\n        mat2d.polygonOffset = true;\n        mat2d.polygonOffsetFactor = -1;\n        mat2d.polygonOffsetUnits = 0.1;    // 1.0 is usually way too high, see LMV-1072\n        mat2d.cutplanes = _otherCutPlanes; // make sure that cap meshes respect cutplanes from other tools\n\n        var box = new THREE.Box3();\n\n        //var worldBox = _viewer.getVisibleBounds(true);   \n        \n        //some heuristic for line width of the section outline based on model size.\n        //half a percent of the model size is what we do here.\n        //var lineWidth = 0.5 * 5e-5 * worldBox.size().length();\n\n        var models = _viewer.modelQueue().getModels().filter(m => !m.getDoNotCut());\n\n        var intersects = [];\n        var material;\n\n        // Start iterating the fragments\n        _fragIterator.start(models, 50, function(fragId, dbId, model, lastFrag) {\n\n            // Collect intersections for this fragment\n            var frags = model.getFragmentList();\n            frags.getWorldBounds(fragId, box);\n            if (cg.xBoxPlane(plane, box)) {\n                var m = frags.getVizmesh(fragId);\n\n                if (m.geometry && !m.geometry.is2d && !m.geometry.isLines && m.material.cutplanes) {\n                    material = m.material;\n                    cg.xMeshPlane(plane, m, intersects);\n                }\n            }\n\n            // If this is the last fragment for dbId, process the intersections\n            if (lastFrag) {\n                if (intersects.length) {\n\n                    var bbox = new THREE.Box3();\n                    cg.convertToPlaneCoords(toPlaneCoords, intersects, bbox);\n\n                    //Create the 2D line geometry\n                    var vbb = new avp.VertexBufferBuilder(false, 8 * intersects.length);\n\n                    var color = getDiffuseColor(material);\n                    var r = 0|(color.r * 0.25)*255.5;\n                    var g = 0|(color.g * 0.25)*255.5;\n                    var b = 0|(color.b * 0.25)*255.5;\n\n                    var c = 0xff000000 | (b<<16) | (g<<8) | r;\n\n\n                    var eset = new cg.EdgeSet(intersects, bbox, bbox.size().length() * 1e-6);\n                    eset.snapEdges();\n                    eset.sanitizeEdges();\n                    eset.stitchContours();\n\n                    //Create the 3D mesh\n                    var cset = eset.triangulate();\n\n//Testing code path using the fancier DCEL structure for triangulation of the section edges.\n//TODO: compare quality and performance before switching to this and retiring the EdgeSet code path\n/*\n                    var dcel = new DCEL(bbox, bbox.size().length() * 1e-6);\n                    intersects.forEach(e => {\n                        dcel.addDirectedEdge(e.v1.x, e.v1.y, e.v2.x, e.v2.y, true, dbId);\n                    });\n\n                    dcel.finalize(true);\n\n                    let cset = dcel.closedAreas[0];\n*/\n\n                    if (cset) {\n    /*\n                        if (cset.triangulationFailed)\n                            c = 0xffffff00;\n    */\n\n                        for (let j=0; j<cset.contours.length; j++) {\n\n                            var cntr = cset.contours[j];\n\n                            for (var k=1; k<cntr.length; k++) {\n                                var pt1 = cset.pts[cntr[k-1]];\n                                var pt2 = cset.pts[cntr[k]];\n                                vbb.addSegment(pt1.x, pt1.y, pt2.x, pt2.y, 0, -2.0, /*isClosed ? c : rc*/c, dbId, 0);\n                            }\n\n                        }\n\n\n                        var mdata = { mesh: vbb.toMesh() };\n\n                        avp.BufferGeometryUtils.meshToGeometry(mdata);\n\n                        var bg2d = mdata.geometry;\n                        bg2d.streamingDraw = true;\n                        bg2d.streamingIndex = true;\n\n                        var mesh2d = new THREE.Mesh(bg2d, mat2d);\n\n                        mesh2d.matrix.copy(fromPaneCoords);\n                        mesh2d.matrixAutoUpdate = false;\n                        mesh2d.frustumCulled = false;\n                        mesh2d.modelId = model.id;      // So we can look it up later\n                        mesh2d.dbId = dbId;\n                        section2D.add(mesh2d);\n\n                        //Create triangulated capping polygon\n                        {\n                            if (!cset.triangulationFailed) {\n\n                                var bg = cset.toPolygonMesh(material.packedNormals);\n\n                                var mat = _viewer.matman().cloneMaterial(material, model);\n\n                                mat.packedNormals = material.packedNormals;\n                                mat.cutplanes = _otherCutPlanes; // make sure that cap meshes respect cutplanes from other tools\n                                mat.side = THREE.FrontSide;\n                                mat.depthTest = true;\n                                mat.map = null;\n                                mat.bumpMap = null;\n                                mat.normalMap = null;\n                                mat.alphaMap = null;\n                                mat.specularMap = null;\n                                mat.transparent = false;\n                                mat.depthWrite = true;\n                                mat.hatchPattern = true;\n                                mat.needsUpdate = true;\n\n                                var angle = (material.id+2) * Math.PI * 0.125;\n                                var tan = Math.tan(angle);\n                                mat.hatchParams = new THREE.Vector2(tan, 10.0);\n                                mat.hatchTintColor = _tintColor;\n                                mat.hatchTintIntensity = _tintIntensity;\n\n                                // If the material is prism, clear all the map definitions.\n                                if (mat.prismType != null) {\n                                    mat.defines = {};\n                                    mat.defines[mat.prismType.toUpperCase()] = \"\";\n                                    if (mat.prismType == \"PrismWood\") {\n                                        mat.defines[\"NO_UVW\"] = \"\";\n                                    }\n                                }\n\n                                var capmesh = new THREE.Mesh(bg, mat);\n                                capmesh.matrix.copy(fromPaneCoords);\n                                capmesh.matrixAutoUpdate = false;\n                                capmesh.modelId = model.id;      // So we can look it up later\n                                capmesh.dbId = dbId;\n                                capmesh.fragId = intersects.fragId;\n\n                                section3D.add(capmesh);\n                            }\n\n                        }\n\n                    }\n                }\n\n                // Clear intersections for the next dbId\n                intersects.length = 0;\n            } // last Fragment for dbId\n\n        }); //_fragIterator.start\n\n    }\n\n    // We use an own cut plane set to distinguish our own cut planes from others.\n    var _ownCutPlaneSet = 'Autodesk.Viewing.Extension.Section.SectionTool';\n\n    // Make sure that the viewer always uses the SectionTool's plane to adjust 2D rendering resolution.\n    _viewer.setCutPlaneSetFor2DRendering(_ownCutPlaneSet);\n\n    // Keep track of cutplanes that are not our own, because we have to apply them to our cap meshes\n    var _otherCutPlanes = [];\n\n    // Trigger update of cap mesh materials if number of cutplanes have changed by other tools\n    function updateCapMaterials() {\n\n        function update(section) {\n            // apply cutplanes to all active cap meshes\n            if (!section) {\n                return;\n            }\n\n            section.traverse(function(obj) {\n                // we only care for THREE.Mesh with material\n                if (!(obj instanceof THREE.Mesh) || !obj.material) {\n                    return;\n                }\n                obj.material.needsUpdate = true;\n            });\n        }\n\n        update(_viewer.scene.getObjectByName(\"section3D\"));\n        update(_viewer.sceneAfter.getObjectByName(\"section2D\"));\n    }\n\n    function createPlaneMesh(plane, bbox) {\n        var quat = new THREE.Quaternion().setFromUnitVectors(new THREE.Vector3(0, 0, 1), plane.normal);\n        var geometry;\n        var size;\n\n        if (bbox) {\n            // project bbox to set plane size\n            var ptMax = plane.projectPoint(bbox.max);\n            var ptMin = plane.projectPoint(bbox.min);\n            var invQuat = quat.clone().inverse();\n            ptMax.applyQuaternion(invQuat);\n            ptMin.applyQuaternion(invQuat);\n            size = new THREE.Vector3().subVectors(ptMax, ptMin);\n            geometry = new THREE.PlaneBufferGeometry(size.x, size.y);\n        } else {\n            // project bounding sphere\n            bbox = _viewer.getVisibleBounds();\n            size = 2.0 * bbox.getBoundingSphere().radius;\n            geometry = new THREE.PlaneBufferGeometry(size, size);\n        }\n\n        var material = new THREE.MeshBasicMaterial({\n            opacity: 0,\n            color: _selectionColor,\n            side: THREE.DoubleSide,\n            depthTest: false,\n            depthWrite: false,\n            transparent: true\n        });\n\n        var mesh = new SectionMeshClass(geometry, material, plane);\n        var pt = plane.projectPoint(bbox.getCenter());       \n        mesh.position.copy(pt);\n        mesh.quaternion.multiply(quat);\n\n        // add outlines with inverted background color\n        var presetIndex = _viewer.currentLightPreset();\n        presetIndex = Math.max(0, presetIndex);\n        var bgColor = Autodesk.Viewing.Private.LightPresets[presetIndex].bgColorGradient;\n        var color = \"rgb(\" + (255-bgColor[0]) + \",\" + (255-bgColor[1]) + \",\" + (255-bgColor[2]) + \")\";\n        var lineMaterial = new THREE.LineBasicMaterial({color: color, linewidth:1, depthTest: false});\n        var pos = mesh.geometry.getAttribute('position');\n        for (var i = 0; i < _outlineIndices.length; i++) {\n            geometry = new THREE.Geometry();\n            geometry.vertices.push(new THREE.Vector3().fromArray(pos.array, _outlineIndices[i][0] * pos.itemSize),\n                                   new THREE.Vector3().fromArray(pos.array, _outlineIndices[i][1] * pos.itemSize));\n            var line = new THREE.Line(geometry, lineMaterial);\n            mesh.add(line);\n            mesh.outlines.push(line);\n        }\n\n        return mesh;\n    }\n\n    function updatePlaneMeshes(rebuild) {\n    \n        traverseSections(function(child) {\n            if (child instanceof SectionMeshClass) {\n\n                var i, line, pos, pt;\n                if (child.connectivity.length > 0) {\n                    // section box\n                    var minv = new THREE.Matrix4().getInverse(child.matrixWorld);\n                    pt = new THREE.Vector3();\n                    pos = child.geometry.getAttribute('position');\n                    for (i = 0; i < pos.length / pos.itemSize; i++) {\n                        var connect = child.connectivity[i];\n                        if (intersectPlanes(child.plane, connect[0], connect[1], pt) !== null) {\n                            pt.applyMatrix4(minv);\n                            pos.setXYZ(i, pt.x, pt.y, pt.z);\n                        }\n                    }\n                    pos.needsUpdate = true;\n                    child.geometry.computeBoundingBox();\n                    child.geometry.computeBoundingSphere();\n\n                    for (i = 0; i < child.outlines.length; i++) {\n                        line = child.outlines[i];\n                        line.geometry.vertices[0].fromArray(pos.array, _outlineIndices[i][0] * pos.itemSize);\n                        line.geometry.vertices[1].fromArray(pos.array, _outlineIndices[i][1] * pos.itemSize);\n                        line.geometry.verticesNeedUpdate = true;\n                    }\n                } else {\n                    // section plane\n                    if (rebuild) {\n                        var bbox = _viewer.getVisibleBounds();\n                        var size = 2.0 * bbox.getBoundingSphere().radius;\n                        pt = child.plane.projectPoint(bbox.getCenter());\n                        child.geometry = new THREE.PlaneBufferGeometry(size, size);\n                        child.position.copy(pt);\n                        pos = child.geometry.getAttribute('position');\n                        for (i = 0; i < child.outlines.length; i++) {\n                            line = child.outlines[i];\n                            line.geometry.vertices[0].fromArray(pos.array, _outlineIndices[i][0] * pos.itemSize);\n                            line.geometry.vertices[1].fromArray(pos.array, _outlineIndices[i][1] * pos.itemSize);\n                            line.geometry.verticesNeedUpdate = true;\n                        }\n                    }\n                }\n            }\n        });\n    }\n\n    function traverseSections(callback) {\n        for (var i = 0; i < _sectionGroups.length; i++) {           \n            _sectionGroups[i].traverse(callback);\n        }\n    }\n\n    function setSectionPlanes(fireEvent=true) {\n        traverseSections(function(child) {\n            if (child instanceof SectionMeshClass) {\n                child.update();\n            }\n        });\n        if (_sectionPlanes.length === 1) {\n            updateCapMeshes(new THREE.Plane().setComponents(_sectionPlanes[0].x, _sectionPlanes[0].y, _sectionPlanes[0].z, _sectionPlanes[0].w));\n        }\n        _viewer.setCutPlaneSet(_ownCutPlaneSet, _sectionPlanes, fireEvent);\n    }\n\n    function showPlane(set) {\n        for (var i = 0; i < _sectionGroups.length; i++) {\n            _sectionGroups[i].visible = set;\n        }\n        \n        if (_isPlaneOn !== set)\n            updateViewer();\n\n        _isPlaneOn = set;\n    }\n\n    function showSection(set) {\n        if (set && _sectionPlanes.length > 0) {\n            if (_sectionPlanes.length === 1) {\n                updateCapMeshes(new THREE.Plane().setComponents(_sectionPlanes[0].x, _sectionPlanes[0].y, _sectionPlanes[0].z, _sectionPlanes[0].w));\n            }\n            _viewer.setCutPlaneSet(_ownCutPlaneSet, _sectionPlanes);\n        }\n        showPlane(set);\n    }\n\n    function attachControl(control, mesh) {\n        control.attach(mesh);\n        control.setPosition(mesh.position);\n        control.visible = true;\n    }\n\n    function checkNormal(normal) {\n        // flip normal if facing inward as eye direction\n        var eyeVec = _viewer.api.navigation.getEyeVector();\n        if (eyeVec.dot(normal) > 0) {\n            normal.negate();\n        }\n\n        return normal;\n    }\n\n    function setPlane(normal, distance, fireEvent=true) {\n        var obbox = _viewer.getVisibleBounds();\n        var center = obbox.getCenter();\n        var group = new THREE.Group();\n        // Calculate the plane signed distance using the dot product of the center point of the scene bounding box\n        // and the normal vector.\n        distance = (distance !== undefined) ? distance : -1 * center.dot(normal);\n        var plane = new THREE.Plane(normal, distance);\n        var mesh = createPlaneMesh(plane, null);\n        group.add(mesh);\n        _sectionPlanes.push(mesh.planeVec);\n        _sectionGroups.push(group);\n        _viewer.addOverlay(_overlayName, group);\n        if (_transRotControl) {\n            attachControl(_transRotControl, mesh);\n            mesh.material.opacity = 0;\n            centerPlaneArrow(mesh);\n            _transRotControl.showRotationGizmos(true);\n            _sectionPicker = _transRotControl.getPicker();\n            \n        }\n        setSectionPlanes(fireEvent);\n        if (_active) {\n            updateControls();\n        }\n    }\n\n    function getCenterPoint(mesh) {\n        var middle = new THREE.Vector3();\n        var geometry = mesh.geometry;\n    \n        geometry.computeBoundingBox();\n    \n        middle.x = (geometry.boundingBox.max.x + geometry.boundingBox.min.x) / 2;\n        middle.y = (geometry.boundingBox.max.y + geometry.boundingBox.min.y) / 2;\n        middle.z = (geometry.boundingBox.max.z + geometry.boundingBox.min.z) / 2;\n    \n        mesh.localToWorld( middle );\n        return middle;\n    }\n\n    /**\n     * Places the arrow at the center of the passed in mesh.\n     * @param {*} mesh \n     */\n    function centerPlaneArrow(mesh) {\n        if (!_transRotControl || !mesh) return false;\n        // Get the center of the plane and \n        // calculate the x,y,z offset between the plane position and the plane center\n        var centerOffset = getCenterPoint(mesh).sub(mesh.position);\n        centerOffset.sub(_trcOffset);\n        // Set the gizmo offset\n        _transRotControl.setGizmoOffset(centerOffset);\n        return true;\n    }\n\n    function setBox(planeSet) {\n        var normals = [\n            new THREE.Vector3(1, 0, 0), \n            new THREE.Vector3(0, 1, 0), \n            new THREE.Vector3(0, 0, 1),\n            new THREE.Vector3(-1, 0, 0),\n            new THREE.Vector3(0, -1, 0),\n            new THREE.Vector3(0, 0, -1)\n        ];\n\n        var connectivities = [\n            [[1, 2], [1, 5], [2, 4], [4, 5]], // 0\n            [[3, 5], [0, 5], [2, 3], [0, 2]], // 1\n            [[1, 3], [0, 1], [3, 4], [0, 4]], // 2\n            [[1, 5], [1, 2], [4, 5], [2, 4]], // 3\n            [[2, 3], [0, 2], [3, 5], [0, 5]], // 4\n            [[0, 1], [3, 1], [0, 4], [3, 4]]  // 5\n        ];\n\n        var group = new THREE.Group();\n        var obbox = _viewer.getVisibleBounds();\n        var center = obbox.getCenter();\n        var bbox = new THREE.Box3(obbox.min, center);\n        \n        // Initialize from planeSet ONLY if it's an AABB.\n        var loadingBox = false;\n        if (planeSet && planeSet.length === 6 && planeSet[0].x === 1.0) {\n            // Assume that the order on planes is the same as in Array of normals defined above\n            bbox = new THREE.Box3(\n                new THREE.Vector3(planeSet[3].w, planeSet[4].w, planeSet[5].w),\n                new THREE.Vector3(planeSet[0].w, planeSet[1].w, planeSet[2].w)\n            );\n            center = bbox.max.clone();\n            loadingBox = true;\n        }\n\n        ////center = obbox.max;   // Use this to initialize the box around the model\n        ////bbox = obbox.clone(); // Use this to initialize the box around the model\n\n        var planes = [], meshes = [];\n        var i, mesh, plane;\n        for (i = 0; i < normals.length; i++) {\n\n            if (loadingBox) {\n                plane = new THREE.Plane(normals[i], planeSet[i].w);\n                planes.push(plane);\n            }\n            else \n            {\n                plane = new THREE.Plane(normals[i], -1 * center.dot(normals[i]));\n                planes.push(plane);\n\n                // offset plane with negative normal to form an octant\n                if (i > 2) {\n                    var ptMax = plane.orthoPoint(bbox.max);\n                    var ptMin = plane.orthoPoint(bbox.min);\n                    var size = new THREE.Vector3().subVectors(ptMax, ptMin);\n                    plane.constant -= size.length();\n                }\n            }\n\n            mesh = createPlaneMesh(plane, bbox);\n            group.add(mesh);\n            meshes.push(mesh);\n            _sectionPlanes.push(mesh.planeVec);\n        }\n\n        // build connectivity\n        for (i = 0; i < meshes.length; i++) {\n            mesh = meshes[i];\n            var connectivity = connectivities[i];\n            for (var j = 0; j < connectivity.length; j++) {\n                var nc = [];\n                var ct = connectivity[j];\n                for (var k = 0; k < ct.length; k++) {\n                    nc.push(planes[ct[k]]);\n                }\n                mesh.connectivity.push(nc);\n            }\n        }\n        \n        _sectionGroups.push(group);\n        _viewer.addOverlay(_overlayName, group);\n\n        setSectionPlanes();\n        updatePlaneMeshes();\n\n        plane = _sectionGroups[0].children[0];\n        attachControl(_transRotControl, plane);\n        // Set the plane opacity\n        plane.material.opacity = _selectionOpacity;\n        centerPlaneArrow(plane);\n\n        attachControl(_transControl, _sectionGroups[0]);\n        _transRotControl.showRotationGizmos(false);\n        _sectionPicker = _transRotControl.getPicker().concat(_transControl.getPicker());\n        // Calculate the offset to the max point of the bounding box.\n        var sectionBoxPosition = _sectionGroups[0].position.clone();\n        var cornerOffset = sectionBoxPosition.sub(center.clone());\n        _transControl.setGizmoOffset(cornerOffset);\n    }\n\n    var intersectPlanes = (function () {\n        var m = new THREE.Matrix3();\n        var n23 = new THREE.Vector3();\n        var n31 = new THREE.Vector3();\n        var n12 = new THREE.Vector3();\n        return function(plane1, plane2, plane3, optionalTarget) {\n            m.set(plane1.normal.x, plane1.normal.y, plane1.normal.z,\n                  plane2.normal.x, plane2.normal.y, plane2.normal.z,\n                  plane3.normal.x, plane3.normal.y, plane3.normal.z);\n            \n            var det = m.determinant();\n            if (det === 0) return null;\n\n            n23.crossVectors(plane2.normal, plane3.normal).multiplyScalar(-plane1.constant);\n            n31.crossVectors(plane3.normal, plane1.normal).multiplyScalar(-plane2.constant);\n            n12.crossVectors(plane1.normal, plane2.normal).multiplyScalar(-plane3.constant);\n\n            var result = optionalTarget || new THREE.Vector3();\n            return result.copy(n23).add(n31).add(n12).divideScalar(det);\n        };\n    })();\n\n    var intersectObjects = function(pointer, objects, recursive) {\n        return THREE.TransformControls.intersectObjects(pointer.canvasX, pointer.canvasY, objects, _viewer.camera, recursive);\n    };\n        \n    // public functions\n\n    /**\n     * When active, the geometry will be sectioned by the current set cut plane.\n     * @returns {boolean}\n     */\n    this.isActive = function() {\n        return _active;\n    };\n\n    /**\n     * Returns the signed distance of the sectioning plane from the origin\n     * @returns {Number} distance. Null distance is returned if there is no hit found from raycast\n     */\n    this.getSectionDistance = function(normal) {\n        // Find a target point in the direction of the camera \n        var eyeVec = _viewer.api.navigation.getEyeVector();\n        var hit = _viewer.rayIntersect(new THREE.Ray(_viewer.camera.position, eyeVec));\n        // DIstance\n        return hit && hit.intersectPoint && -1 * hit.intersectPoint.dot(normal);\n    };\n\n    /**\n     * Enables the cut planes that were created by the viewer.setCutPlanes() function.\n     * @param {boolean} [fireEvent] - if set to false the av.CUTPLANES_CHANGE_EVENT event will not be fired.\n     */\n    this.setViewerSection = function(fireEvent=true) {\n        this.clearSection(fireEvent);\n        var normal;\n        // Attempt to initialize the tool with a plane that is already set.\n        var planeSet = _viewer.getCutPlaneSet('__set_view');\n        if (planeSet.length !== 1) return;\n\n        _transRotControl.clientScale = 1;\n        var v4 = planeSet[0];\n        normal = new THREE.Vector3(v4.x, v4.y, v4.z);\n        var distance = v4.w;\n        setPlane(normal, distance, fireEvent);\n        _activeMode = 'SET_VIEW_PLANE';\n        // Clear sections from Viewer3D::setView\n        _viewer.setCutPlaneSet('__set_view', undefined, fireEvent);        \n    };\n\n    \n\n    /**\n     * Facilitates the initialization of a cut plane\n     * \n     * @param {String} name - Either 'X', 'Y', 'Z' or 'BOX'\n     */\n    this.setSection = function(name) {\n        this.clearSection();\n        _trcOffset = new THREE.Vector3();\n        var normal, distance;\n        _transRotControl.clientScale = 1;\n\n        // Attempt to initialize the tool with a plane that is already set.\n        var planeSet = _viewer.getCutPlaneSet('__set_view');\n        if (planeSet.length === 1 && name !== 'BOX' && name !== 'OBJ_SET_VIEW_PLANE') {\n            name = 'SET_VIEW_PLANE';\n        }\n        \n        switch (name) {\n            case 'X':\n                normal = new THREE.Vector3(1, 0, 0);\n                distance = this.getSectionDistance(normal);\n                setPlane(checkNormal(normal), distance);\n                break;\n            case 'Y':\n                normal = new THREE.Vector3(0, 1, 0);\n                distance = this.getSectionDistance(normal);\n                setPlane(checkNormal(normal), distance);\n                break;\n            case 'Z':\n                normal = new THREE.Vector3(0, 0, 1);\n                distance = this.getSectionDistance(normal);\n                setPlane(checkNormal(normal), distance);\n                break;\n            case 'OBJ_SET_VIEW_PLANE':\n            case 'SET_VIEW_PLANE':\n                var v4 = planeSet[0];\n                normal = new THREE.Vector3(v4.x, v4.y, v4.z);\n                setPlane(normal, v4.w);\n                break;\n            case 'OBJ_BOX':\n            case 'BOX':\n                setBox(planeSet);\n                _transRotControl.clientScale = 2;\n                this.recomputePivot();\n                break;\n        }\n        _activeMode = name;\n        \n        // Clear sections from Viewer3D::setView\n        _viewer.setCutPlaneSet('__set_view', undefined);\n    };\n\n    /**\n     * Facilitates the initialization of a cut plane from a normal and distance\n     *\n     * @param {THREE.Vector4} normal (x,y,z) and distance (w)\n     * @param {Number} distance\n     */\n    this.setSectionFromPlane = function(cutplane) {\n        this.clearSection();\n        setPlane(new THREE.Vector3(cutplane.x, cutplane.y, cutplane.z), cutplane.w);\n        _activeMode = \"\";\n\n        // Clear sections from Viewer3D::setView\n        _viewer.setCutPlaneSet('__set_view', undefined);\n    };\n\n    /**\n     * Set the active mode\n     * @param {string} [name] - active mode name\n     * @private\n     */\n    this.setActiveMode = function(name) {\n        _activeMode = name || \"\";\n    };\n\n    /**\n     * Remove the section graphics\n     */\n    function _removeSections() {\n        var oldsection3D = _viewer.scene.getObjectByName(\"section3D\");\n        if (oldsection3D)\n            _viewer.scene.remove(oldsection3D);\n        var oldsection2D = _viewer.sceneAfter.getObjectByName(\"section2D\");\n        if (oldsection2D)\n            _viewer.sceneAfter.remove(oldsection2D);\n    }\n\n    this.setDisplaySectionHatches = function(value) {\n        _displaySectionHatches = value;\n    };\n\n    this.updateCapMeshes = function(plane) {\n        if (!plane) {\n            return;\n        }\n\n        setPlane(plane.normal, plane.constant);\n        updateCapMeshes(plane);\n    };\n\n    /**\n     * Removes any (and all) currently set cut plane(s).\n     * @param {boolean} [fireEvent] - if set to false the av.CUTPLANES_CHANGE_EVENT event will not be fired.\n     */\n    this.clearSection = function(fireEvent=true) {\n\n        if (_transRotControl)\n            _transRotControl.detach();\n\n        if (_transControl)\n            _transControl.detach();\n\n        // remove all sections\n        while(_sectionPlanes.length > 0) {\n            _sectionPlanes.pop();\n        }\n\n        while(_sectionGroups.length > 0) {\n            var group = _sectionGroups.pop();\n            _viewer.removeOverlay(_overlayName, group);\n        }\n\n        _fragIterator.start(null);      // Shutdown iterator        \n        _removeSections();\n\n        _viewer.setCutPlaneSet(_ownCutPlaneSet, null, fireEvent);\n    };\n\n    this.isPlaneOn = function() {\n        return _isPlaneOn;\n    };\n\n    this.showPlane = function(set) {\n        showPlane(set);\n    };\n\n    /**\n     * Whether translation and rotation controls are visible or not.\n     * @param {Boolean} set\n     */\n    this.attachControl = function(set) {\n        if (!_transRotControl || !_transControl) {\n            return;\n        }\n\n        if (set) {\n            attachControl(_transRotControl, _sectionGroups[0].children[0]);\n            _transRotControl.highlight();\n            if (_activeMode === 'BOX')\n                attachControl(_transControl, _sectionGroups[0]);\n        } else {\n            _transRotControl.detach();\n            _transControl.detach();\n        }\n    };\n\n    /**\n     * Invokes setSection with the last set of parameters used.\n     */\n    this.resetSection = function() {\n        this.setSection(_activeMode);\n    };\n\n    // tool interface\n\n    this.getNames = function() {\n        return _names;\n    };\n\n    this.getName = function() {\n        return _names[0];\n    };\n\n    this.register = function() {\n    };\n\n    this.deregister = function() {\n        this.clearSection();\n        deinitControl();\n    };\n\n    this.getPriority = function() {\n        return _priority;\n    };\n\n    /**\n     * [ToolInterface] Activates the tool\n     * @param {String} name - unused\n     */\n    this.activate = function(/*name*/) {\n\n        initControl();\n\n        _active = true;\n        _isDragging = false;\n        _visibleAtFirst = true;\n\n        // keep only one section all the time per design\n        _sectionPlanes = _sectionPlanes || [];\n\n        showSection(true);\n    };\n\n    /**\n     * [ToolInterface] Deactivates the tool\n     * @param {String} name - unused\n     */\n    this.deactivate = function(/*name*/) {\n        _active = false;\n        _isDragging = false;\n\n        if (!this.keepCutPlanesOnDeactivate) {\n            // Clean sections and gizmos when deactivating the tool.\n            _fragIterator.start(null); // Shutdown iterator        \n            _removeSections();\n\n            showSection(false);\n            _viewer.setCutPlaneSet(_ownCutPlaneSet);\n        } else {\n            // In case that keepCutPlanesOnDeactivate is set, the control gizmos will disappear, but the sections will stay.\n            _viewer.removeOverlay(_overlayName, _transRotControl);\n            _viewer.removeOverlay(_overlayName, _transControl);\n\n            for (let i = 0; i < _sectionGroups.length; i++) {\n                _viewer.removeOverlay(_overlayName, _sectionGroups[i]);\n            }\n        }\n        \n        _transRotControl.detach();\n        _transControl.detach();\n    };\n\n    this.update = function(/*highResTimestamp*/) {\n        return false;\n    };\n\n    this.handleSingleClick = function(event/*, button*/) {\n        var pointer = event;\n        var result = intersectObjects(pointer, _sectionGroups[0]?.children);\n        _sectionGroups[0].children.forEach(function(child) {\n            child.material.opacity = 0;\n        });\n        \n        if (result) {\n            const prevObject = _transRotControl.object;\n            attachControl(_transRotControl, result.object);\n            _transRotControl.highlight();\n            result.object.material.opacity = _sectionPlanes.length > 1 ? _selectionOpacity : 0;\n            // Only in case of a section box, and only when clicking on a different plane - re-center the arrow.\n            if (_sectionGroups[0]?.children.length > 1 && prevObject !== result.object) {\n                centerPlaneArrow(result.object);\n            }\n            updateViewer();\n            adjustGizmoToBounds();\n        }\n\n        return false;\n    };\n\n    this.handleDoubleClick = function(/*event, button*/) {\n        return false;\n    };\n\n    this.handleSingleTap = function(event) {\n        return this.handleSingleClick(event, 0);\n    };\n\n    this.handleDoubleTap = function(/*event*/) {\n        return false;\n    };\n\n    this.handleKeyDown = function(/*event, keyCode*/) {\n        return false;\n    };\n\n     this.handleKeyUp = function(/*event, keyCode*/) {\n        return false;\n    };\n\n    this.handleWheelInput = function(/*delta*/) {\n        return false;\n    };\n\n    this.handleButtonDown = function(event/*, button*/) {\n        _isDragging = true;\n        if (_transControl.onPointerDown(event))\n            return true;\n        return _transRotControl.onPointerDown(event);\n    };\n\n    this.handleButtonUp = function(event/*, button*/) {\n        _isDragging = false;\n        if (_boxChanged) {\n            _boxChanged = false;\n            this.recomputePivot();\n        }\n        if (_transControl.onPointerUp(event))\n            return true;\n        return _transRotControl.onPointerUp(event);\n    };\n\n    this.handleMouseMove = function(event) {\n        var oldTransControlPos = _transControl.object ? new THREE.Vector3().copy(_transControl.object.position) : null;\n        // var oldMaxPoint = _transControl.object ? getMaxPoint(_transControl.object) : null;\n        if (_isDragging) {\n            if (_transControl.onPointerMove(event) ) {\n                _boxChanged = true;\n                setSectionPlanes();\n                _transRotControl.update();\n                // Keep track of the section box offset\n                var boxOffset = new THREE.Vector3().copy(_transControl.object.position).sub(oldTransControlPos);\n                // Add the box offset to the section plane offset\n                _trcOffset.add(boxOffset);\n\n                sendAnalyticsDebounced('Canvas', 'Box', 'translate');\n\n                return true;\n            }\n            if (_transRotControl.onPointerMove(event)) {\n                _boxChanged = true;\n                setSectionPlanes();\n                updatePlaneMeshes();\n                // TODO: Try to position the triad to the max corner of the section box when moving the plane arrow.\n                // Currently, it is positioned at the max point of the section box.\n\n                if ( _activeMode.includes('BOX') )\n                    sendAnalyticsDebounced('Canvas', 'Box', 'transform');\n                else {\n                    const mode = _transRotControl.axis.search(\"R\") != -1 ? \"rotate\" : \"translate\";\n                    sendAnalyticsDebounced('Canvas', 'Plane', mode);\n                }\n\n                return true;\n            }\n        }\n\n        _transControl.visible = _transControl.object !== undefined;\n\n        if (event.pointerType !== 'touch') {\n            var pointer = event;\n            var result = intersectObjects(pointer, _sectionGroups[0]?.children);\n            if (result) {\n                _visibleAtFirst = false;\n            }\n\n            // show gizmo + plane when intersecting on non-touch \n            var visible = _visibleAtFirst || (result || intersectObjects(pointer, _sectionPicker, true)) ? true : false;\n            _transRotControl.visible = visible;\n            _transControl.visible = _transControl.visible && visible;\n            showPlane(visible);\n        }\n\n        if (_transControl.onPointerHover(event))\n            return true;\n\n        return _transRotControl.onPointerHover(event);\n    };\n\n    this.handleGesture = function(event) {\n        switch (event.type) {\n            case \"dragstart\":\n                _touchType = \"drag\";\n                // Single touch, fake the mouse for now...\n                return this.handleButtonDown(event, 0);\n\n            case \"dragmove\":\n                return (_touchType === \"drag\") ? this.handleMouseMove(event) : false;\n\n            case \"dragend\":\n                if (_touchType === \"drag\") {\n                    _touchType = null;\n                    return this.handleButtonUp(event, 0);\n                }\n                return false;\n        }\n        return false;\n    };\n\n    this.handleBlur = function(/*event*/) {\n        return false;\n    };\n\n    this.handleResize = function() {\n    };\n\n    this.handlePressHold = function(/*event*/) {\n        // When this method returns true, it will not call the DefaultHandler's handlePressHold.\n        // This makes it not possible to open the context menu on mobile.\n        return false;\n    };\n\n    this.recomputePivot = function() {\n\n        var values = this.getSectionBoxValues(true);\n        if (!values) return;\n\n        var aabb = values.sectionBox;\n\n        _viewer.api.navigation.setPivotPoint(new THREE.Vector3(\n            aabb[0] + (aabb[3] - aabb[0]) * 0.5,\n            aabb[1] + (aabb[4] - aabb[1]) * 0.5,\n            aabb[2] + (aabb[5] - aabb[2]) * 0.5,\n        ));\n    };\n\n    this.getSectionBoxValues = function(ignoreGlobalOffset) {\n\n        var group = _sectionGroups[0];\n        if (!group) {\n            return null;\n        }\n\n        var planes = group.children;\n        if (planes.length < 6) {\n            return null;\n        }\n\n        var right = planes[0].position.x;\n        var top   = planes[1].position.y;\n        var front = planes[2].position.z;\n        var left  = planes[3].position.x;\n        var bttm  = planes[4].position.y;\n        var back  = planes[5].position.z;\n\n        var off = {x:0, y:0, z:0};\n        if (!ignoreGlobalOffset) {\n            off = _viewer.model.getData().globalOffset || off;\n        } \n        \n        var aabb = [\n            Math.min(left, right)   + off.x, \n            Math.min(top,bttm)      + off.y, \n            Math.min(front,back)    + off.z,\n            Math.max(left, right)   + off.x, \n            Math.max(top,bttm)      + off.y, \n            Math.max(front,back)    + off.z,\n        ];\n\n        // Box doesn't support rotation at the moment.\n        // Will have to take it into account if that becomes a feature.\n        var transform = new THREE.Matrix4().identity().toArray();\n        \n        return {\n            sectionBox: aabb,\n            sectionBoxTransform: transform,\n        };\n    };\n\n    this.getSectionPlaneValues = function(ignoreGlobalOffset) {\n\n        var group = _sectionGroups[0];\n        if (!group) {\n            return null;\n        }\n\n        var planes = group.children;\n        if (planes.length !== 1) {\n            return null;\n        }\n\n        var off = {x:0, y:0, z:0};\n        if (!ignoreGlobalOffset) {\n            off = _viewer.model.getData().globalOffset || off;\n        }\n\n        var plane = planes[0].plane;\n        var constant = plane.constant - THREE.Vector3.prototype.dot.call( off, plane.normal );\n\n        return {\n            sectionPlane: [\n                plane.normal.x,\n                plane.normal.y,\n                plane.normal.z,\n                constant\n            ]\n        };\n    };\n    \n    this.getSectionPlaneSet = function() {\n        return _viewer.getCutPlaneSet(_ownCutPlaneSet);  \n    };\n    \n    this.getSectionPlanes = function() {\n        // When restoring a viewer state it is put in __set_view, so return from that set\n        // However, the notifyCutplanesChanged function can call setViewerSection which would\n        // move the planes from __set_view into _ownCutPlaneSet\n        const viewSet = _viewer.getCutPlaneSet('__set_view');\n        if (viewSet.length > 0) {\n            return viewSet;\n        }\n\n        return _viewer.getCutPlaneSet(_ownCutPlaneSet);\n    };\n\n    // Called by viewer if any cutplanes are modified. It makes sure that cutplanes controlled by separate tools\n    // (with own cutplane sets) are considered by our cap meshes.\n    this.notifyCutplanesChanged = function() {\n\n        var numCutPlanesBefore = _otherCutPlanes.length;\n\n        // Collect all active cutplanes from other tools\n        //\n        // NOTE: It's essential that we don't create a new array, but just refill the same one.\n        //       Since the cap meshes are created async, the cutPlaneChange event may come in the middle of\n        //       the cap mesh generation. For consistency, we want all cap meshes to share the same cutplane array.\n        _otherCutPlanes.length = 0;\n        var cpSets = _viewer.getCutPlaneSets();\n        for (var i=0; i<cpSets.length; i++) {\n\n            // skip our own cut planes\n            var cpName = cpSets[i];\n            if (cpName === _ownCutPlaneSet) {\n                continue;\n            }\n\n            // add cutplanes of this set\n            var cp = _viewer.getCutPlaneSet(cpName);\n            for (var j = 0; j < cp.length; j++) {\n                _otherCutPlanes.push(cp[j]);\n            }\n        }\n\n        // Set the section tool to the viewer defined cutplane.\n        if (cpSets.includes(\"__set_view\") && _activeMode !== \"\" && _activeMode.indexOf(\"OBJ_\") === -1) {\n            this.setViewerSection(false);\n        }\n\n        // If the number of cutplanes changed, this requires a shader recompile of the cap materials\n        if (numCutPlanesBefore !== _otherCutPlanes.length) {\n            updateCapMaterials();\n        }\n    };\n\n    /**\n     * Set a section box around the passed in bounding box.\n     * @param {THREE.Box3} box\n     * @returns {boolean} - true if the section box was set\n     */\n    this.setSectionBox = function(box) {\n        if (!box) return false;\n        const name = 'OBJ_BOX';        \n        // Convert the bounding box to planes\n        const planes = Autodesk.Viewing.Private.SceneMath.box2CutPlanes(box, box.transform);\n        _activeMode = name;\n        _viewer.setCutPlaneSet('__set_view', planes);\n        this.setSection(name);\n        return true;\n    };\n\n    /**\n     * Set a section plane at the intersection position.\n     * @param {Three.Vector3} normal - plane normal.\n     * @param {Three.Vector3} position - position to place the plane.\n     * @returns {boolean} - true if the section plane was set\n     */\n    this.setSectionPlane = function(normal, position, enableRotationGizmo = true) {\n        if (!normal || !position) return false;\n        const name = 'OBJ_SET_VIEW_PLANE';\n        const distance = -1 * position.dot(normal);\n        const plane = new THREE.Plane(normal, distance);\n        _activeMode = name;\n        const planeVecs = [new THREE.Vector4(plane.normal.x, plane.normal.y, plane.normal.z, plane.constant)];\n        _viewer.setCutPlaneSet('__set_view', planeVecs);\n        this.setSection(name);\n        // RotationGizmos are turned on by default.\n        // The option to disable it, is for cases like activating the section tool from the context menu.\n        _transRotControl?.showRotationGizmos(enableRotationGizmo);\n        const pos = position.clone().sub(_sectionGroups[0].children[0].position);\n        _transRotControl?.setGizmoOffset(pos);\n        \n        return true;\n    };\n};\n\nfunction init_SectionMesh() {\n\n    if (SectionMeshClass)\n        return;\n\n    SectionMeshClass = function(geometry, material, plane) {\n\n        THREE.Mesh.call(this, geometry, material, false);\n\n        this.plane = plane;\n        this.planeVec = new THREE.Vector4(plane.normal.x, plane.normal.y, plane.normal.z, plane.constant);\n        this.connectivity = [];\n        this.outlines = [];\n    };\n\n    SectionMeshClass.prototype = Object.create(THREE.Mesh.prototype);\n    SectionMeshClass.prototype.constructor = SectionMeshClass;\n\n    SectionMeshClass.prototype.update = function() {\n\n        this.plane.normal.set(0, 0, 1);\n        this.plane.normal.applyQuaternion(this.quaternion);\n\n        var normal = this.plane.normal;\n        var d = -1 * this.getWorldPosition().dot(normal);\n        this.planeVec.set(normal.x, normal.y, normal.z, d);\n        this.plane.constant = d;\n    };\n\n}\n\n","import { SectionTool } from './SectionTool';\nimport './Section.css';\n\nconst avp = Autodesk.Viewing.Private;\nconst AVU = Autodesk.Viewing.UI;\nconst analytics = avp.analytics;\n\n/**\n * The SectionExtension provides ways to cut the geometry using planes or a cube.\n * The extension adds a toolbar button to access the feature.\n *\n * The extension id is: `Autodesk.Section`\n *\n * @param {Viewer3D} viewer - Viewer instance\n * @param {object} options - Configurations for the extension\n * @example \n * viewer.loadExtension('Autodesk.Section')\n * @memberof Autodesk.Viewing.Extensions\n * @alias Autodesk.Viewing.Extensions.SectionExtension\n * @see {@link Autodesk.Viewing.Extension} for common inherited methods.\n * @class\n */\nexport var SectionExtension = function(viewer, options) {\n    Autodesk.Viewing.Extension.call(this, viewer, options);\n    this.viewer = viewer;\n    this.name = 'section';\n    this.modes = ['x','y','z','box'];\n    this.buttons = {};\n\n    this.onViewerSetView = this.onViewerSetView.bind(this);\n    this._onCutPlanesChanged = this._onCutPlanesChanged.bind(this);\n    this._onShowAll = this._onShowAll.bind(this);\n};\n\nSectionExtension.prototype = Object.create(Autodesk.Viewing.Extension.prototype);\nSectionExtension.prototype.constructor = SectionExtension;\n\nvar proto = SectionExtension.prototype;\n\n/**\n * Registers the SectionTool, hotkeys and event handlers.\n *\n * @returns {boolean}\n */\nproto.load = function() {\n    var that = this;\n    var viewer = this.viewer;\n\n    this.tool = new SectionTool(viewer, {\n        tintColor: { r: 1, g: 1, b: 0 },\n        tintIntensity: 0.2\n    });\n\n    viewer.toolController.registerTool(this.tool, this.setActive.bind(this));\n    this.sectionStyle = null;\n    this.supportedStyles = [\"X\", \"Y\", \"Z\", \"BOX\"];\n\n    this.displaySectionHatches = this.displaySectionHatches.bind(this);\n\n    this.viewer.prefs.addListeners(avp.Prefs3D.DISPLAY_SECTION_HATCHES, this.displaySectionHatches);\n\n    viewer.addEventListener(Autodesk.Viewing.SET_VIEW_EVENT, this.onViewerSetView);\n\n    // consider cutplane changes of other tools, so that cap meshes consider them too\n    viewer.addEventListener(Autodesk.Viewing.CUTPLANES_CHANGE_EVENT, this._onCutPlanesChanged);\n    viewer.addEventListener(Autodesk.Viewing.SHOW_ALL_EVENT, this._onShowAll);\n\n    this.HOTKEYS_ID = \"Autodesk.Section.Hotkeys\";\n    var hotkeys = [{\n        keycodes: [\n            Autodesk.Viewing.KeyCode.ESCAPE\n        ],\n        onRelease: function () {\n            if (that.viewer.getAggregateSelection().length === 0)\n                return that.deactivate();\n        }\n    }];\n    viewer.getHotkeyManager().pushHotkeys(this.HOTKEYS_ID, hotkeys);\n\n    // Invoked when the context menu is about to get opened.\n    this.viewer.registerContextMenuCallback('Autodesk.Section', (menu, status) => {\n        onContextMenu(this, menu, status);\n    });\n\n    //Load the required dependency (and return the pending load as the load completion Promise)\n    return this.viewer.loadExtension('Autodesk.CompGeom');\n};\n\n/**\n * Unregisters the SectionTool, hotkeys and event handlers.\n *\n * @returns {boolean}\n */\nproto.unload = function () {\n    var viewer = this.viewer;\n\n    viewer.unregisterContextMenuCallback('Autodesk.Section');\n\n    // remove hotkey\n    viewer.getHotkeyManager().popHotkeys(this.HOTKEYS_ID);\n\n    this.destroyUI();\n\n    viewer.removeEventListener(Autodesk.Viewing.SET_VIEW_EVENT, this.onViewerSetView);\n    viewer.removeEventListener(Autodesk.Viewing.CUTPLANES_CHANGE_EVENT, this._onCutPlanesChanged);\n    viewer.removeEventListener(Autodesk.Viewing.SHOW_ALL_EVENT, this._onShowAll);\n\n    this.viewer.prefs.removeListeners(avp.Prefs3D.DISPLAY_SECTION_HATCHES, this.displaySectionHatches);\n\n    viewer.toolController.deregisterTool(this.tool);\n    this.tool = null;\n\n    return true;\n};\n\n/**\n * Toggles activeness of section planes.\n *\n * @returns {boolean} Whether the section plane is active or not.\n * @alias Autodesk.Viewing.Extensions.SectionExtension#toggle\n */\nproto.toggle = function() {\n    if (this.isActive()) {\n        this.enableSectionTool(false);\n    } else {\n        var style = this.sectionStyle || \"X\";\n        this.setSectionStyle(style, true);\n    }\n    return this.isActive(); // Need to check for isActive() again.\n};\n\n/**\n * Returns the current type of plane that will cut-though the geometry.\n *\n * @returns {null | string} Either \"X\" or \"Y\" or \"Z\" or \"BOX\" or null.\n * @alias Autodesk.Viewing.Extensions.SectionExtension#getSectionStyle\n */\nproto.getSectionStyle = function() {\n    return this.sectionStyle;\n};\n\n/**\n * Sets the Section plane style.\n *\n * @param {string} style - Accepted values are 'X', 'Y', 'Z' and 'BOX' (in Caps)\n * @param {boolean} [preserveSection] - Whether sending the current style value resets the cut planes.\n * @alias Autodesk.Viewing.Extensions.SectionExtension#setSectionStyle\n */\nproto.setSectionStyle = function(style, preserveSection) {\n\n    if (this.supportedStyles.indexOf(style) === -1) {\n        return false;\n    }\n\n    var bActive = this.isActive();\n    var bNewStyle = (this.sectionStyle !== style) || !preserveSection;\n    this.sectionStyle = style;\n\n    if (bActive && bNewStyle) {\n        this.tool.setSection(style);\n    }\n    else if (!bActive) {\n        this.enableSectionTool(true);\n        if (bNewStyle) {\n            this.tool.setSection(style);\n        } else {\n            this.tool.attachControl(true);\n        }\n    }\n    return true;\n};\n\n/**\n * Use to set the section from an externally defined plane. For showing with line pattern\n * Tool itself will be disabled when setting the plane\n *\n * @param {THREE.Vector4} cutplane - send null to clear the section\n */\nproto.setSectionFromPlane = function(cutplane) {\n    this.deactivate();\n\n    if (cutplane) {\n        this.tool.setSectionFromPlane(cutplane);\n        this.tool.attachControl(false);\n        // LMV-5299\n        if (!this.isActive()) {\n            this.tool.showPlane(false);\n        }\n    } else {\n        this.tool.clearSection();\n        var prevLock = this.viewer.toolController.setIsLocked(false);\n        this.enableSectionTool(false);\n        this.viewer.toolController.setIsLocked(prevLock);\n    }\n};\n\n/**\n * Returns the planes belonging only to the Section tool's set*\n */\nproto.getSectionPlanes = function() {\n    return this.tool.getSectionPlanes();\n};\n\n/**\n *\n * @param enable\n * @param keepCutPlanes - keep existing cut planes when deactivating the tool.\n * @returns {boolean}\n * @private\n */\nproto.enableSectionTool = function(enable, keepCutPlanes=false) {\n    var toolController = this.viewer.toolController,\n        isActive = this.tool.isActive();\n\n    if (enable && !isActive) {\n        toolController.activateTool(\"section\");\n        if (this.sectionToolButton) {\n            this.sectionToolButton.setState(Autodesk.Viewing.UI.Button.State.ACTIVE);\n        }\n        return true;\n\n    } else if (!enable && isActive) {\n        const prevKeepCutPlanes = this.tool.keepCutPlanesOnDeactivate;\n        this.tool.keepCutPlanesOnDeactivate = keepCutPlanes;\n        toolController.deactivateTool(\"section\");\n        this.tool.keepCutPlanesOnDeactivate = prevKeepCutPlanes;\n\n        if (this.sectionToolButton) {\n            this.sectionToolButton.setState(Autodesk.Viewing.UI.Button.State.INACTIVE);\n        }\n        return true;\n    } else if (enable) {\n        toolController.activateToolModality(\"section\");\n    }\n    return false;\n};\n\n/**\n * Returns an object that reperesents the state of the section planes\n * currently applied to the viewer by this extension.\n * \n * @param {THREE.Vector3 | object} [ignoreGlobalOffset=false]\n * \n * @returns {object | null}\n */\nproto.getViewValues = function(ignoreGlobalOffset) {\n\n    var boxValues = this.tool.getSectionBoxValues(ignoreGlobalOffset);\n    if (boxValues)\n        return boxValues;\n\n    var planeValues = this.tool.getSectionPlaneValues(ignoreGlobalOffset);\n    if (planeValues)\n        return planeValues;\n\n    return null;\n};\n\n/**\n * Gets the extension state as a plain object. Invoked automatically by viewer.getState()\n *\n * @param {object} viewerState - Object to inject extension values.\n * @alias Autodesk.Viewing.Extensions.SectionExtension#getState\n */\nproto.getState = function(viewerState) {\n    if (!this.viewer.model || this.viewer.model.is2d()) {\n        return;\n    }\n\n    viewerState.cutplanes = viewerState.cutplanes || [];\n    var planes = this.tool.getSectionPlaneSet();\n    for (var i = 0; i < planes.length; i++) {\n        viewerState.cutplanes.push(planes[i].toArray());\n    }\n};\n\n/**\n * Restores the extension state from a given object. Invoked automatically by viewer.restoreState()\n *\n * @param {object} viewerState - Viewer state.\n * @returns {boolean} True if restore operation was successful.\n * @alias Autodesk.Viewing.Extensions.SectionExtension#restoreState\n */\nproto.restoreState = function(viewerState) {\n    // If viewerState doesn't contain cutplanes, we should leave it as is.\n    if (!viewerState.cutplanes) {\n        return;\n    }\n    const cutplanes = this.getSectionPlanes();\n    this.setSectionFromPlane(null);   // Unload any existing planes first\n    if (cutplanes.length === 1) {\n        this.setSectionFromPlane(cutplanes[0]);\n    }\n    \n    return true;\n};\n\n/**\n * @private\n */\nproto._onCutPlanesChanged = function(/*event*/) {\n    this.tool.notifyCutplanesChanged();\n};\n\n\n/**\n * @private\n */\nproto._onShowAll = function(/*event*/) {\n    this.deactivate();\n};\n\n/**\n * Set a section box around the passed in THREE.Box3.\n * This method will also enable the section tool.\n *\n * @param {THREE.Box3} box - used to set the section box.\n * @alias Autodesk.Viewing.Extensions.SectionExtension#setSectionBox\n */\nproto.setSectionBox = function(box) {\n    if (!box) return;\n    this.enableSectionTool(true);\n    if (this.tool.setSectionBox(box)) {\n        this.activeStatus = true;\n        this.viewer.clearSelection();\n\n        // Update current mode and button state.\n        this.mode = 'box';\n        this.buttons[this.mode]?.setState(AVU.Button.State.ACTIVE);\n    } else {\n        this.enableSectionTool(false);\n    }\n};\n\n/**\n * Place a section plane on the Intersection.\n * This method will also enable the section tool.\n *\n * @param {THREE.Vector3} normal - plane normal.\n * @param {THREE.Vector3} point - position to place the plane.\n * @param enableRotationGizmo\n * @alias Autodesk.Viewing.Extensions.SectionExtension#setSectionPlane\n */\nproto.setSectionPlane = function(normal, point, enableRotationGizmo) {\n    if (!normal || !point) return;\n    this.enableSectionTool(true);\n    if (this.tool.setSectionPlane(normal, point, enableRotationGizmo)) {\n        this.activeStatus = true;\n        this.viewer.clearSelection();\n\n        // Update current mode and button state.\n        this.mode = this.calculateNearestAxis(normal);\n        this.buttons[this.mode]?.setState(AVU.Button.State.ACTIVE);\n    } else {\n        this.enableSectionTool(false);\n    }\n};\n\n/**\n * Given a normal, return the x, y or z, according to the nearest world axis.\n * \n * @param {THREE.Vector3} normal - plane normal.\n */\nproto.calculateNearestAxis = function (normal) {\n    // absolute values for direction cosines, bigger value equals closer to basis axis\n    const xn = Math.abs(normal.x);\n    const yn = Math.abs(normal.y);\n    const zn = Math.abs(normal.z);\n\n    if ((xn >= yn) && (xn >= zn)) {\n        return 'x';\n    } else if ((yn > xn) && (yn >= zn)) {\n        return 'y';\n    } else {\n        return `z`;\n    }\n};\n\n/**\n * @private\n */\nproto.onViewerSetView = function(/*event*/) {\n    this.deactivate();\n};\n\n/**\n * @param toolbar\n */\nproto.onToolbarCreated = function(toolbar) {\n\n    this.sectionToolButton = new AVU.ComboButton(\"toolbar-sectionTool\");\n    this.sectionToolButton.setToolTip('Section analysis');\n    this.sectionToolButton.setIcon(\"adsk-icon-section-analysis\");\n    this.createSubmenu(this.sectionToolButton);\n\n    // make sure inspect tools is visible\n    var modelTools = toolbar.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID);\n\n    // place section tool before reset tool\n    if (modelTools) {\n        var resetTool = modelTools.getControl(\"toolbar-resetTool\");\n        if (resetTool) {\n            modelTools.addControl(this.sectionToolButton, {index: modelTools.indexOf(resetTool.getId())});\n        } else {\n            modelTools.addControl(this.sectionToolButton, {index: 0});\n        }\n    }\n};\n\n/**\n *\n * @param parentButton\n * @private\n */\nproto.createSubmenu = function(parentButton)\n{\n    var that = this;\n    var viewer = this.viewer;\n\n    /**\n     * @param button\n     * @param name\n     * @private\n     */\n    function createNavToggler(button, name) {\n        that.buttons[name] = button;\n\n        return function() {\n            var state = button.getState();\n            var enable = function() {\n                if (button instanceof AVU.ComboButton === false) {\n                    that.activate(name);\n                } else {\n                    that.enableSectionTool(true);\n                    that.tool.attachControl(true);\n                }\n            };\n\n            const sectionType = name.toLowerCase().indexOf('box') !== -1 ? 'Box' : 'Plane';\n\n            if (state === AVU.Button.State.INACTIVE) {\n                button.setState(AVU.Button.State.ACTIVE);\n                // Long initialization may cause issues on touch enabled devices, make it async\n                if (Autodesk.Viewing.isMobileDevice()) {\n                    setTimeout(enable, 1);\n                } else {\n                    enable();\n                }\n                analytics.track('viewer.section', {\n                    From: 'Toolbar',\n                    Type: sectionType,\n                    action: 'Enable',\n                });\n            } else if (state === AVU.Button.State.ACTIVE) {\n                button.setState(AVU.Button.State.INACTIVE);\n                that.deactivate();\n                analytics.track('viewer.section', {\n                    From: 'Toolbar',\n                    Type: sectionType,\n                    action: 'Disable',\n                });\n            }\n            that.sectionStyle = name.toUpperCase();\n        };\n    }\n\n    /**\n     *\n     */\n    function updateSectionButtons() {\n        var areVectorsEqual = (function () {\n            var v = new THREE.Vector3();\n            return function(a, b, sqtol) {\n                v.subVectors(a, b);\n                return v.lengthSq() < sqtol;\n            };\n        })();\n\n        var unitx = new THREE.Vector3(1, 0, 0);\n        var unity = new THREE.Vector3(0, 1, 0);\n        var unitz = new THREE.Vector3(0, 0, 1);\n        var right = viewer.autocam.getWorldRightVector();\n        var up = viewer.autocam.getWorldUpVector();\n        var front = viewer.autocam.getWorldFrontVector();\n\n        var tol = 0.0001;\n        if (areVectorsEqual(up, unitx, tol)) {\n            that.sectionYButton.setIcon(\"adsk-icon-plane-x\");\n        } else if (areVectorsEqual(up, unitz, tol)) {\n            that.sectionYButton.setIcon(\"adsk-icon-plane-z\");\n        } else {\n            that.sectionYButton.setIcon(\"adsk-icon-plane-y\");\n        }\n\n        if (areVectorsEqual(right, unity, tol)) {\n            that.sectionXButton.setIcon(\"adsk-icon-plane-y\");\n        } else if (areVectorsEqual(right, unitz, tol)) {\n            that.sectionXButton.setIcon(\"adsk-icon-plane-z\");\n        } else {\n            that.sectionXButton.setIcon(\"adsk-icon-plane-x\");\n        }\n\n        if (areVectorsEqual(front, unitx, tol)) {\n            that.sectionZButton.setIcon(\"adsk-icon-plane-x\");\n        } else if (areVectorsEqual(front, unity, tol)) {\n            that.sectionZButton.setIcon(\"adsk-icon-plane-y\");\n        } else {\n            that.sectionZButton.setIcon(\"adsk-icon-plane-z\");\n        }\n\n    }\n\n    var sectionXButton = this.sectionXButton = new AVU.Button(\"toolbar-sectionTool-x\");\n    sectionXButton.setToolTip('Add X plane');\n    sectionXButton.setIcon(\"adsk-icon-plane-x\");\n    sectionXButton.onClick = createNavToggler(sectionXButton, 'x');\n    parentButton.addControl(sectionXButton);\n\n    var sectionYButton = this.sectionYButton = new AVU.Button(\"toolbar-sectionTool-y\");\n    sectionYButton.setToolTip('Add Y plane');\n    sectionYButton.setIcon(\"adsk-icon-plane-y\");\n    sectionYButton.onClick = createNavToggler(sectionYButton, 'y');\n    parentButton.addControl(sectionYButton);\n\n    var sectionZButton = this.sectionZButton = new AVU.Button(\"toolbar-sectionTool-z\");\n    sectionZButton.setToolTip('Add Z plane');\n    sectionZButton.setIcon(\"adsk-icon-plane-z\");\n    sectionZButton.onClick = createNavToggler(sectionZButton, 'z');\n    parentButton.addControl(sectionZButton);\n\n    var sectionBoxButton = this.sectionBoxButton = new AVU.Button(\"toolbar-sectionTool-box\");\n    sectionBoxButton.setToolTip('Add box');\n    sectionBoxButton.setIcon(\"adsk-icon-box\");\n    sectionBoxButton.onClick = createNavToggler(sectionBoxButton, 'box');\n    parentButton.addControl(sectionBoxButton);\n\n    if (viewer.model) {\n        updateSectionButtons();\n    } else {\n        viewer.addEventListener(Autodesk.Viewing.MODEL_ADDED_EVENT, updateSectionButtons, { once: true });\n    }\n};\n\n/**\n * @private\n */\nproto.destroyUI = function() {\n    \n    if (this.sectionToolButton) {\n        this.sectionToolButton.removeFromParent();\n        this.sectionToolButton = null;\n\n        this.buttons = {};\n    }\n};\n\n/**\n * Activates a section plane for user to interact with.\n * It performs the same action as the UI button.\n * \n * @param {string} mode - Accepted values are 'x', 'y', 'z' and 'box' (in lowercase)\n * @returns {boolean} - true if the activation was successful.\n * @alias Autodesk.Viewing.Extensions.SectionExtension#activate\n */\nproto.activate = function (mode) {\n    if (this.activeStatus && this.mode === mode) {\n        return;\n    }\n    this.enableSectionTool(true);\n    switch (mode) {\n        default:\n        case 'x':\n            this.tool.setSection('X');\n            this.mode = 'x';\n            break;\n        case 'y':\n            this.tool.setSection('Y');\n            this.mode = 'y';\n            break;\n        case 'z':\n            this.tool.setSection('Z');\n            this.mode = 'z';\n            break;\n        case 'box':\n            this.tool.setSection('BOX');\n            this.mode = 'box';\n            break;\n        }\n    this.activeStatus = true;\n    return true;\n};\n\n/**\n * Removes the section plane/box from the 3D canvas.\n * \n * @param keepCutPlanes - keep existing cut planes when deactivating the tool. Default is false.\n *\n * @alias Autodesk.Viewing.Extensions.SectionExtension#deactivate\n * @returns {boolean} - returns true if deactivated, false otherwise.\n */\nproto.deactivate = function (keepCutPlanes) {\n    if(this.activeStatus) {\n        this.tool.setActiveMode(\"\");\n        this.enableSectionTool(false, keepCutPlanes);\n        this.activeStatus = false;\n        return true;\n    }\n    return false;\n};\n\n/**\n * Turns display hatches on or off.\n * @param {boolean} value - if true all section planes will get the hatches applied, otherwise, the section planes will not have the hatches.\n */\nproto.displaySectionHatches = function (value) {\n    \n    this.tool.setDisplaySectionHatches(value);\n\n    if (this.activeStatus) {\n        const planes = this.getSectionPlanes();\n        this.tool.clearSection();\n        // update the hatches for each existing plane\n        planes.forEach((plane) => {\n            this.tool.updateCapMeshes(new THREE.Plane().setComponents(plane.x, plane.y, plane.z, plane.w));\n        });\n    }\n};\n\n\n/**\n * Invoked when the context menu is about to be created.\n * Adds additional entries to the context menu.\n *\n * @param section\n * @param menu\n * @param status\n * @private\n */\nfunction onContextMenu(section, menu, status) {\n\n    if (!status.hasSelected)\n        return;\n\n    const viewer = section.viewer;\n\n    const aggregateSelection = viewer.getAggregateSelection();\n\n    // This case is relevant mostly for hypermodel viewing, when there are 2D planes living in a 3D scene.\n    // In this case, it make no sense to allow \"section-box\" to a plane.\n    if (aggregateSelection.length === 1 && aggregateSelection[0].model.is2d()) {\n        return;\n    }\n\n    const bbox = viewer.impl.selector.getSelectionBounds();\n\n    const menuEntry = {\n        title: \"Section\",\n        target: []\n    };\n\n    menuEntry.target.push({\n        title: 'Section Box',\n        target: () => {\n            section.setSectionBox(bbox);\n            analytics.track('viewer.section', {\n                From: 'Contextual',\n                Type: 'Box',\n                action: 'Enable',\n            });\n        }\n    });\n\n    const selected = aggregateSelection.map(selectionObject => selectionObject.selection).flat();\n    const modelIds = aggregateSelection.map(selectionObject => selectionObject.model.id);\n    const intersection = viewer.impl.hitTest(status.canvasX, status.canvasY, false, selected, modelIds);\n    \n    // Ensure that the selected object is the on that recieved the context click.\n    if (intersection?.face?.normal && intersection.model && selected.indexOf(intersection.dbId) !== -1) {\n\n        const mesh = viewer.impl.getRenderProxy(intersection.model, intersection.fragId);\n        const normalMatrix = new THREE.Matrix3().getNormalMatrix(mesh.matrixWorld);\n        const normal = intersection.face.normal.clone().applyMatrix3(normalMatrix).normalize();\n\n        menuEntry.target.push({\n            title: 'Section Plane',\n            target: () => {\n                section.setSectionPlane(normal, intersection.point, false);\n                analytics.track('viewer.section', {\n                    From: 'Contextual',\n                    Type: 'Plane',\n                    action: 'Enable',\n                });\n            }\n        });\n    }\n\n    menu.push(menuEntry);\n}\n\n\n// Make the extension available\nAutodesk.Viewing.theExtensionManager.registerExtension('Autodesk.Section', SectionExtension);\n"],"sourceRoot":""}